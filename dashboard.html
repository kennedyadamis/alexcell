<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - ALEXCELL & CIA</title>
    <link rel="icon" href="logos/1.png?v=2" type="image/png">
    <!-- Import Map para resolver depend√™ncias do Supabase -->
    <script type="importmap">
    {
        "imports": {
            "@supabase/supabase-js": "https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.50.2/+esm"
        }
    }
    </script>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="pattern-lock-local.css">
</head>
<body>
    <!-- Bot√£o para toggle do menu mobile -->
    <button class="mobile-menu-toggle" id="mobile-menu-toggle">
        ‚ò∞
    </button>
    
    <!-- Overlay para fechar menu mobile -->
    <div class="sidebar-overlay" id="sidebar-overlay"></div>
    
    <div class="dashboard-container">
        <!-- Sidebar de Navega√ß√£o -->
        <aside class="dashboard-sidebar" id="dashboard-sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="logo">ALEXCELL</a>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li class="nav-item active" data-module="os">
                        <a href="#">
                            <span class="nav-icon">üìã</span>
                            <span class="nav-text">Ordens de Servi√ßo</span>
                        </a>
                    </li>
                    <li class="nav-item" data-module="pdv">
                        <a href="#">
                            <span class="nav-icon">üõí</span>
                            <span class="nav-text">Venda R√°pida</span>
                        </a>
                    </li>
                    <li class="nav-item" data-module="caixa">
                        <a href="#">
                            <span class="nav-icon">üí∞</span>
                            <span class="nav-text">Caixa</span>
                        </a>
                    </li>
                    <li class="nav-item" data-module="estoque">
                        <a href="#">
                            <span class="nav-icon">üì¶</span>
                            <span class="nav-text">Estoque</span>
                        </a>
                    </li>
                    <li class="nav-item" data-module="clientes">
                        <a href="#">
                            <span class="nav-icon">üë•</span>
                            <span class="nav-text">Clientes</span>
                        </a>
                    </li>
                    <li class="nav-item" data-module="relatorios">
                        <a href="#">
                            <span class="nav-icon">üìä</span>
                            <span class="nav-text">Relat√≥rios</span>
                        </a>
                    </li>
                    <li class="nav-item" data-module="configuracoes">
                        <a href="#">
                            <span class="nav-icon">‚öôÔ∏è</span>
                            <span class="nav-text">Configura√ß√µes</span>
                        </a>
                    </li>
                    <li class="nav-item" data-module="usuarios-permissoes">
                        <a href="#">
                            <span class="nav-icon">üë•</span>
                            <span class="nav-text">Usu√°rios e Permiss√µes</span>
                        </a>
                    </li>
                    <li class="nav-item" data-module="trocar-senha">
                        <a href="#">
                            <span class="nav-icon">üîí</span>
                            <span class="nav-text">Trocar Senha</span>
                        </a>
                    </li>
                    <li class="nav-item" data-module="garantia">
                        <a href="#">
                            <span class="nav-icon">üõ°Ô∏è</span>
                            <span class="nav-text">Garantia</span>
                        </a>
                    </li>
                </ul>
            </nav>
            <div class="sidebar-footer">
                <button id="btn-switch-store" class="switch-store-button" style="display: none;">
                    <span class="nav-icon">üîÑ</span>
                    <span class="nav-text">Trocar de Loja</span>
                </button>
                <button id="logout-btn" class="logout-button">
                    <span class="nav-icon">üö™</span>
                    <span class="nav-text">Sair</span>
                </button>
        </div>
        </aside>

        <!-- Conte√∫do Principal do Dashboard -->
        <main class="dashboard-main-content">
            <!-- Barra de Usu√°rio Superior -->
            <header class="main-header">
                <div class="user-welcome">
                    <h2 id="module-title">Ordens de Servi√ßo</h2>
                </div>
                <div class="user-info-bar">
                    <div class="user-welcome">
                        <p><span id="user-name">Usu√°rio</span> (<span id="user-role" class="user-role-badge">...</span>)</p>
                    </div>
                </div>
            </header>
            
            <div class="module-container">
                <!-- M√≥dulo: Ordens de Servi√ßo -->
                <div id="module-os" class="module-page active">
                            <div class="module-actions">
                        <button class="btn btn-primary" id="btn-new-os">‚ûï Nova OS</button>
                    </div>
                    
                    <!-- Barra de Pesquisa para Ordens de Servi√ßo -->
                    <div class="os-search-section form-panel">
                        <div class="search-container">
                            <div class="search-input-group">
                                <input type="text" id="os-search-input" placeholder="üîç Buscar por cliente ou telefone..." class="search-input">
                                <button type="button" id="btn-search-os" class="btn btn-secondary search-btn">Buscar</button>
                                <button type="button" id="btn-clear-os-search" class="btn btn-outline clear-search-btn">Limpar</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="os-table-container">
                            <div class="os-table-container">
                                <table class="os-table">
                                    <thead>
                                        <tr>
                                            <th>OS #</th>
                                            <th>Cliente</th>
                                            <th>Equipamento</th>
                                            <th>Problema</th>
                                            <th>Status</th>
                                            <th>Data</th>
                                            <th>A√ß√µes</th>
                                        </tr>
                                    </thead>
                                    <tbody id="os-table-body">
                                        <!-- Dados ser√£o inseridos dinamicamente -->
                                    </tbody>
                                </table>
                            </div>
                        <div class="pagination-controls" id="os-pagination">
                            <button class="btn btn-secondary" id="os-prev-page">Anterior</button>
                            <span id="os-page-info"></span>
                            <button class="btn btn-secondary" id="os-next-page">Pr√≥ximo</button>
                        </div>
                                        </div>
                                    </div>
                                    
                <!-- M√≥dulo: Ponto de Venda (PDV) -->
                <div id="module-pdv" class="module-page" style="display: none;">
                    <div class="module-header">
                        <h1>Ponto de Venda (Venda R√°pida)</h1>
                    </div>
                    <div class="pdv-container">
                        <!-- Coluna da Esquerda: Busca e Carrinho -->
                        <div class="pdv-main">
                            <div class="pdv-search-section form-panel">
                                <h3>Buscar Produto</h3>
                                <div class="form-group autocomplete-container">
                                    <input type="text" id="pdv-product-search" placeholder="Digite o nome ou c√≥digo do produto...">
                                    <div id="pdv-product-results" class="autocomplete-results"></div>
                                </div>
                            </div>
                            <div class="pdv-cart-section">
                                <h3>Carrinho</h3>
                                <div class="pdv-cart-items">
                                    <div class="pdv-cart-item header">
                                        <span>Produto</span>
                                        <span>Qtd.</span>
                                        <span>Pre√ßo Unit.</span>
                                        <span>Subtotal</span>
                                        <span>A√ß√£o</span>
                                    </div>
                                    <div id="pdv-cart-body">
                                        <!-- Itens do carrinho ser√£o inseridos aqui -->
                                    </div>
                                </div>
                            </div>

                            <!-- Se√ß√£o de Hist√≥rico de Vendas -->
                            <div class="pdv-history-section form-panel">
                                <h3>Hist√≥rico de Vendas do Dia</h3>
                                <div id="pdv-history-content">
                                    <!-- O hist√≥rico ser√° carregado aqui -->
                                </div>
                            </div>
                        </div>
                        <!-- Coluna da Direita: Resumo e Pagamento -->
                        <div class="pdv-sidebar form-panel">
                            <h3>Resumo da Venda</h3>
                            <div class="pdv-summary">
                                <div class="summary-row">
                                    <span>Subtotal</span>
                                    <span id="pdv-summary-subtotal">R$ 0,00</span>
                                </div>
                                <div class="summary-row">
                                    <span>Desconto (R$)</span>
                                    <input type="number" id="pdv-summary-discount" value="0.00" step="0.01">
                                </div>
                                <div class="summary-row total">
                                    <span>Total a Pagar</span>
                                    <span id="pdv-summary-total">R$ 0,00</span>
                                </div>
                            </div>
                            <div class="pdv-payment">
                                <h3>Pagamento</h3>
                                <div class="form-group">
                                    <!-- Remover o seletor de forma de pagamento √∫nico -->
                                    <!-- <label>Forma de Pagamento</label>
                                    <select id="pdv-payment-method">
                                        <option value="dinheiro">Dinheiro</option>
                                        <option value="credito">Cart√£o de Cr√©dito</option>
                                        <option value="debito">Cart√£o de D√©bito</option>
                                        <option value="pix">PIX</option>
                                    </select> -->
                                </div>
                                <button id="pdv-finish-btn" class="btn btn-primary btn-block">Finalizar Venda</button>
                            </div>
                        </div>
                    </div>
                </div>
                                    
                <!-- M√≥dulo: Caixa -->
                <div id="module-caixa" class="module-page" style="display: none;">
                    <div id="cash-register-module">
                        <!-- Tela de Caixa Fechado -->
                        <div id="cash-closed-view" class="form-panel text-center" style="display: none;">
                            <h2>Caixa Fechado</h2>
                            <p>N√£o h√° um caixa aberto no momento.</p>
                            <button id="btn-open-cash-register" class="btn btn-primary btn-large">Abrir Novo Caixa</button>
                        </div>

                        <!-- Tela de Caixa Aberto -->
                        <div id="cash-open-view" style="display: none;">
                            <div class="module-header">
                                <h1>Gerenciamento de Caixa</h1>
                                <div class="module-actions">
                                    <button id="btn-add-money" class="btn btn-success">‚ûï Adicionar Dinheiro</button>
                                    <button id="btn-withdraw-money" class="btn btn-warning">‚ûñ Retirar Dinheiro</button>
                                    <button id="btn-close-cash-register" class="btn btn-danger">Fechar Caixa</button>
                                </div>
                            </div>
                            <div class="cash-summary-panel">
                                <!-- Resumos ser√£o inseridos aqui -->
                            </div>
                            <div class="cash-entries-panel form-panel">
                                <div class="cash-entries-header">
                                <h3>Movimenta√ß√µes do Caixa</h3>
                                    <div class="cash-filter">
                                        <label for="cash-filter-date">Filtrar por data:</label>
                                        <input type="date" id="cash-filter-date">
                                        <button id="btn-filter-cash" class="btn btn-sm btn-primary">Filtrar</button>
                                        <button id="btn-reset-filter" class="btn btn-sm">Todos</button>
                                    </div>
                                </div>
                                <div id="cash-entries-table">
                                    <!-- Tabela de movimenta√ß√µes ser√° inserida aqui -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="cash-history-panel form-panel">
                        <h3>Hist√≥rico de Caixas Anteriores</h3>
                        <div id="cash-history-list">
                            <!-- Lista de caixas fechados ser√° inserida aqui -->
                        </div>
                                        </div>
                                    </div>
                                    
                <!-- M√≥dulos Placeholder -->
                <div id="module-estoque" class="module-page" style="display: none;">
                    <div class="module-header">
                        <h1>Controle de Estoque</h1>
                        <div class="module-actions">
                            <button class="btn btn-secondary" id="btn-manage-categories">üè∑Ô∏è Gerenciar Categorias</button>
                            <button class="btn btn-primary" id="btn-new-product">‚ûï Adicionar Produto</button>
                        </div>
                    </div>

                    <!-- Formul√°rio de Novo Produto (Oculto) -->
                    <div id="new-product-form-container" class="form-panel" style="display: none;">
                        <h3 id="product-form-title">Adicionar Novo Produto</h3>
                        <form id="new-product-form" class="os-form compact-form">
                            <input type="hidden" id="product-edit-id">
                            <div class="form-row">
                                <div class="form-group" style="flex: 3;">
                                    <label>Nome do Produto *</label>
                                    <input type="text" id="product-name" required>
                                </div>
                                <div class="form-group" style="flex: 2;">
                                    <label>Categoria</label>
                                    <div class="category-input-group">
                                        <select id="product-category"></select>
                                        <button type="button" id="btn-new-category" class="btn btn-secondary btn-sm" title="Nova Categoria">+</button>
                                    </div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Valor de Custo (R$)</label>
                                    <input type="text" id="product-cost-price" placeholder="Ex: 1.500,00">
                                </div>
                                <div class="form-group">
                                    <label>Valor de Venda (R$) *</label>
                                    <input type="text" id="product-sell-price" placeholder="Ex: 2.500,00" required>
                                </div>
                                <div class="form-group">
                                    <label>Qtd. em Estoque</label>
                                    <input type="number" id="product-stock" placeholder="0">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="product-track-stock" checked>
                                    Controlar Estoque deste item
                                </label>
                            </div>
                            <div class="form-actions">
                                <button type="submit" class="btn btn-primary">üíæ Salvar Produto</button>
                                <button type="button" class="btn btn-secondary" id="btn-cancel-new-product">Cancelar</button>
                            </div>
                        </form>
                    </div>

                    <!-- Filtros da Tabela -->
                    <div class="table-filters form-panel">
                        <div class="form-row">
                            <div class="form-group" style="flex: 2;">
                                <label>Buscar por Nome</label>
                                <input type="text" id="stock-search-name" placeholder="Digite o nome do produto...">
                            </div>
                            <div class="form-group" style="flex: 1;">
                                <label>Filtrar por Categoria</label>
                                <select id="stock-filter-category"></select>
                            </div>
                        </div>
                    </div>

                    <!-- Tabela de Produtos -->
                    <div class="stock-table-container">
                        <table class="os-table">
                            <thead>
                                <tr>
                                    <th>Nome</th>
                                    <th>Categoria</th>
                                    <th>Custo</th>
                                    <th>Venda</th>
                                    <th>Estoque</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="products-table-body">
                                <!-- Dados dos produtos ser√£o inseridos aqui -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Controles de Pagina√ß√£o -->
                    <div class="pagination-container" style="margin-top: 20px; display: flex; justify-content: space-between; align-items: center;">
                        <div class="pagination-info">
                            <span id="pagination-info-text">Mostrando 0 de 0 produtos</span>
                        </div>
                        <div class="pagination-controls">
                            <button id="btn-first-page" class="btn btn-secondary" title="Primeira p√°gina">‚èÆÔ∏è</button>
                            <button id="btn-prev-page" class="btn btn-secondary" title="P√°gina anterior">‚¨ÖÔ∏è</button>
                            <span id="pagination-pages" style="margin: 0 15px;">P√°gina 1 de 1</span>
                            <button id="btn-next-page" class="btn btn-secondary" title="Pr√≥xima p√°gina">‚û°Ô∏è</button>
                            <button id="btn-last-page" class="btn btn-secondary" title="√öltima p√°gina">‚è≠Ô∏è</button>
                        </div>
                        <div class="pagination-size">
                            <label for="page-size-select">Itens por p√°gina:</label>
                            <select id="page-size-select" style="margin-left: 5px;">
                                <option value="10">10</option>
                                <option value="25" selected>25</option>
                                <option value="50">50</option>
                                <option value="100">100</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- M√≥dulo: Clientes -->
                <div id="module-clientes" class="module-page" style="display: none;">
                    <div class="module-header">
                        <h1>Gerenciamento de Clientes</h1>
                        <div class="module-actions">
                            <button class="btn btn-primary" id="btn-new-customer">‚ûï Novo Cliente</button>
                                        </div>
                                    </div>
                                    
                    <!-- Filtro da Tabela de Clientes -->
                    <div class="table-filters form-panel">
                                        <div class="form-group">
                            <label>Buscar Cliente por Nome ou Telefone</label>
                            <input type="text" id="customer-search-input" placeholder="Digite para buscar...">
                                        </div>
                                    </div>
                                    
                    <!-- Formul√°rio de Novo Cliente (Oculto) -->
                    <div id="new-customer-form-container" class="form-panel" style="display: none;">
                        <h3>Cadastrar Novo Cliente</h3>
                        <form id="new-customer-form" class="os-form compact-form">
                            <div class="form-columns">
                                <!-- Coluna Esquerda -->
                                <div class="form-column">
                                    <h4>Informa√ß√µes Pessoais</h4>
                                    <div class="form-group">
                                        <label>Nome Completo *</label>
                                        <input type="text" id="new-customer-name" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Telefone</label>
                                        <input type="tel" id="new-customer-phone" placeholder="(XX) XXXXX-XXXX">
                                    </div>
                                    <div class="form-group">
                                        <label>Data de Nascimento</label>
                                        <input type="date" id="new-customer-birth-date">
                                    </div>
                                    </div>
                                <!-- Coluna Direita -->
                                <div class="form-column">
                                    <h4>Endere√ßo</h4>
                                    <div class="form-row">
                                        <div class="form-group" style="flex: 3;">
                                            <label>Logradouro (Rua, Av.)</label>
                                            <input type="text" id="new-customer-street">
                                        </div>
                                        <div class="form-group" style="flex: 1;">
                                            <label>N¬∫</label>
                                            <input type="text" id="new-customer-number">
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>Bairro</label>
                                            <input type="text" id="new-customer-neighborhood">
                                        </div>
                                        <div class="form-group">
                                            <label>Cidade</label>
                                            <input type="text" id="new-customer-city">
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group" style="flex: 1;">
                                            <label>Estado</label>
                                            <input type="text" id="new-customer-state" placeholder="UF" maxlength="2">
                                        </div>
                                        <div class="form-group" style="flex: 1;">
                                            <label>CEP</label>
                                            <input type="text" id="new-customer-zip" placeholder="00000-000">
                                        </div>
                                    </div>
                                </div>
                                </div>
                            <div class="form-actions">
                                <button type="submit" class="btn btn-primary">üíæ Salvar Cliente</button>
                                <button type="button" class="btn btn-secondary" id="btn-cancel-new-customer">Cancelar</button>
                            </div>
                        </form>
                    </div>

                    <!-- Tabela de Clientes -->
                    <div class="customer-table-container">
                        <table class="os-table">
                            <thead>
                                <tr>
                                    <th>Nome</th>
                                    <th>Telefone</th>
                                    <th>Data de Cadastro</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="customers-table-body">
                                <!-- Dados dos clientes ser√£o inseridos aqui -->
                            </tbody>
                        </table>
                        <div class="pagination-controls" id="customers-pagination">
                            <button class="btn btn-secondary" id="customers-prev-page">Anterior</button>
                            <span id="customers-page-info"></span>
                            <button class="btn btn-secondary" id="customers-next-page">Pr√≥ximo</button>
                        </div>
                    </div>
                        </div>

    <!-- MODAL DE EDI√á√ÉO DE CLIENTE -->
    <div id="edit-customer-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Editar Cliente</h2>
                <button id="btn-close-edit-customer-modal" class="close-modal-btn">&times;</button>
            </div>
            <div class="modal-body">
                <form id="edit-customer-form" class="os-form" novalidate>
                    <input type="hidden" id="edit-customer-id">
                    
                    <div class="form-columns">
                        <!-- Coluna Esquerda -->
                        <div class="form-column">
                            <h4>Informa√ß√µes Pessoais</h4>
                            <div class="form-group">
                                <label>Nome Completo *</label>
                                <input type="text" id="edit-customer-name" required>
                            </div>
                            <div class="form-group">
                                <label>Telefone</label>
                                <input type="tel" id="edit-customer-phone" placeholder="(XX) XXXXX-XXXX">
                            </div>
                            <div class="form-group">
                                <label>Data de Nascimento</label>
                                <input type="date" id="edit-customer-birth-date">
                            </div>
                        </div>
                        <!-- Coluna Direita -->
                        <div class="form-column">
                            <h4>Endere√ßo</h4>
                            <div class="form-row">
                                <div class="form-group" style="flex: 1;">
                                    <label>CEP</label>
                                    <input type="text" id="edit-customer-zip" placeholder="00000-000">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group" style="flex: 3;">
                                    <label>Logradouro (Rua, Av.)</label>
                                    <input type="text" id="edit-customer-street">
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label>N¬∫</label>
                                    <input type="text" id="edit-customer-number">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Bairro</label>
                                    <input type="text" id="edit-customer-neighborhood">
                                </div>
                                <div class="form-group">
                                    <label>Cidade</label>
                                    <input type="text" id="edit-customer-city">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group" style="flex: 1;">
                                    <label>Estado</label>
                                    <input type="text" id="edit-customer-state" placeholder="UF" maxlength="2">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-actions modal-actions">
                        <button type="button" id="btn-cancel-edit-customer" class="btn btn-secondary">Cancelar</button>
                        <button type="submit" class="btn btn-primary">üíæ Salvar Altera√ß√µes</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- MODAL DE VISUALIZA√á√ÉO DE CLIENTE -->
    <div id="view-customer-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìã Detalhes do Cliente</h2>
                <button id="btn-close-view-customer-modal" class="close-modal-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="customer-details-container">
                    <div class="form-columns">
                        <!-- Coluna Esquerda -->
                        <div class="form-column">
                            <div class="detail-section">
                                <h4>üë§ Informa√ß√µes Pessoais</h4>
                                <div class="detail-item">
                                    <label>Nome Completo:</label>
                                    <span id="view-customer-name">-</span>
                                </div>
                                <div class="detail-item">
                                    <label>Telefone:</label>
                                    <span id="view-customer-phone">-</span>
                                </div>
                                <div class="detail-item">
                                    <label>Data de Nascimento:</label>
                                    <span id="view-customer-birth-date">-</span>
                                </div>
                                <div class="detail-item">
                                    <label>Data de Cadastro:</label>
                                    <span id="view-customer-created-at">-</span>
                                </div>
                            </div>
                        </div>
                        <!-- Coluna Direita -->
                        <div class="form-column">
                            <div class="detail-section">
                                <h4>üìç Endere√ßo</h4>
                                <div class="detail-item">
                                    <label>CEP:</label>
                                    <span id="view-customer-zip">-</span>
                                </div>
                                <div class="detail-item">
                                    <label>Logradouro:</label>
                                    <span id="view-customer-street">-</span>
                                </div>
                                <div class="detail-item">
                                    <label>N√∫mero:</label>
                                    <span id="view-customer-number">-</span>
                                </div>
                                <div class="detail-item">
                                    <label>Bairro:</label>
                                    <span id="view-customer-neighborhood">-</span>
                                </div>
                                <div class="detail-item">
                                    <label>Cidade:</label>
                                    <span id="view-customer-city">-</span>
                                </div>
                                <div class="detail-item">
                                    <label>Estado:</label>
                                    <span id="view-customer-state">-</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button type="button" id="btn-edit-from-view" class="btn btn-primary">‚úèÔ∏è Editar Cliente</button>
                <button type="button" id="btn-close-view-modal" class="btn btn-secondary">Fechar</button>
            </div>
        </div>
    </div>

    <!-- MODAL DE CONFIRMA√á√ÉO DE EXCLUS√ÉO -->
    <div id="delete-customer-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>‚ö†Ô∏è Confirmar Exclus√£o</h2>
                <button id="btn-close-delete-customer-modal" class="close-modal-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="delete-confirmation-content">
                    <div class="warning-icon">üóëÔ∏è</div>
                    <p class="confirmation-message">
                        Tem certeza que deseja excluir o cliente <strong id="delete-customer-name">-</strong>?
                    </p>
                    <p class="warning-text">
                        Esta a√ß√£o n√£o pode ser desfeita e todos os dados do cliente ser√£o permanentemente removidos.
                    </p>
                </div>
            </div>
            <div class="modal-actions">
                <button type="button" id="btn-confirm-delete-customer" class="btn btn-danger">üóëÔ∏è Sim, Excluir</button>
                <button type="button" id="btn-cancel-delete-customer" class="btn btn-secondary">Cancelar</button>
            </div>
        </div>
    </div>

                <!-- M√≥dulo: Garantia -->
                <div id="module-garantia" class="module-page" style="display: none;">
                    <div class="module-header">
                        <h1>Gerenciamento de Garantias</h1>
                        <div class="module-actions">
                            <button class="btn btn-primary" id="btn-new-warranty">‚ûï Nova Garantia</button>
                        </div>
                    </div>
                    
                    <!-- Barra de Pesquisa para Garantias -->
                    <div class="warranty-search-section form-panel">
                        <div class="search-container">
                            <div class="search-input-group">
                                <input type="text" id="warranty-search-input" placeholder="üîç Buscar por cliente ou equipamento..." class="search-input">
                                <button type="button" id="btn-search-warranty" class="btn btn-secondary search-btn">Buscar</button>
                                <button type="button" id="btn-clear-warranty-search" class="btn btn-outline clear-search-btn">Limpar</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tabela de Garantias -->
                    <div class="warranty-table-container">
                        <table class="os-table">
                            <thead>
                                <tr>
                                    <th>Garantia #</th>
                                    <th>Cliente</th>
                                    <th>Equipamento</th>
                                    <th>Pe√ßa Substitu√≠da</th>
                                    <th>Valor</th>
                                    <th>Data</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="warranty-table-body">
                                <!-- Dados ser√£o inseridos dinamicamente -->
                            </tbody>
                        </table>
                        <div class="pagination-controls" id="warranty-pagination">
                            <button class="btn btn-secondary" id="warranty-prev-page">Anterior</button>
                            <span id="warranty-page-info"></span>
                            <button class="btn btn-secondary" id="warranty-next-page">Pr√≥ximo</button>
                        </div>
                    </div>
                        </div>

                <div id="module-relatorios" class="module-page" style="display: none;">
                    <div class="module-header">
                        <h1>Relat√≥rios Gerenciais</h1>
                    </div>
                    <div class="reports-container">
                        <!-- Se√ß√£o: Relat√≥rio de OS por Status -->
                        <div class="report-section form-panel">
                            <h3>Relat√≥rio de OS por Status</h3>
                            <div class="report-controls">
                                <p>Gere relat√≥rios detalhados das ordens de servi√ßo por status espec√≠fico.</p>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Status das OS</label>
                                        <select id="os-status-filter" class="form-control">
                                            <option value="">Selecione um status</option>
                                            <option value="progress">Em Conserto</option>
                                            <option value="awaiting_pickup">Aguardando Retirada</option>
                                            <option value="delivered">Entregue</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Data de In√≠cio</label>
                                        <input type="date" id="os-report-start-date" class="form-control">
                                    </div>
                                    <div class="form-group">
                                        <label>Data de Fim</label>
                                        <input type="date" id="os-report-end-date" class="form-control">
                                    </div>
                                </div>
                                <button id="btn-generate-os-status-report" class="btn btn-primary">Gerar Relat√≥rio</button>
                            </div>
                            <div id="os-status-report-content" class="report-content">
                                <!-- O relat√≥rio ser√° exibido aqui -->
                            </div>
                        </div>

                        <!-- Se√ß√£o: Relat√≥rio de Produtos Mais Vendidos -->
                        <div class="report-section form-panel">
                            <h3>Produtos Mais Vendidos</h3>
                            <div class="report-controls">
                                <p>Veja um ranking dos produtos mais vendidos em todo o per√≠odo.</p>
                                <button id="btn-generate-top-products-report" class="btn btn-primary">Gerar Relat√≥rio</button>
                            </div>
                            <div id="top-products-report-content" class="report-content">
                                <!-- O relat√≥rio ser√° exibido aqui -->
                            </div>
                        </div>

                        <!-- Se√ß√£o: Relat√≥rio de Fluxo de Caixa -->
                        <div class="report-section form-panel">
                            <h3>Relat√≥rio de Fluxo de Caixa por Per√≠odo</h3>
                            <div class="report-controls">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Data de In√≠cio</label>
                                        <input type="date" id="report-start-date">
                                    </div>
                                    <div class="form-group">
                                        <label>Data de Fim</label>
                                        <input type="date" id="report-end-date">
                                    </div>
                                </div>
                                <button id="btn-generate-cash-flow-report" class="btn btn-primary">Gerar Relat√≥rio</button>
                                <button id="btn-generate-cash-flow-pdf" class="btn btn-success" style="margin-left: 10px;">Gerar PDF</button>
                            </div>
                            <div id="cash-flow-report-content" class="report-content">
                                <!-- O relat√≥rio ser√° exibido aqui -->
                            </div>
                        </div>
                    </div>
                </div>

                <div id="module-configuracoes" class="module-page" style="display: none;">
                    <div class="module-header">
                        <h1>Configura√ß√µes</h1>
                    </div>
                    <div class="settings-container">
                        <!-- Se√ß√£o: Logo para Impress√£o -->
                        <div class="settings-section form-panel">
                            <h3>Logo para Impress√£o</h3>
                            <p>Este logo ser√° usado no cabe√ßalho das Ordens de Servi√ßo impressas.</p>
                            
                            <div class="logo-upload-area">
                                <div class="logo-preview-container">
                                    <img id="print-logo-preview" src="logos/1.png" alt="Preview do Logo" class="logo-preview">
                                </div>
                                <div class="logo-upload-action">
                                    <input type="file" id="logo-uploader" accept="image/png, image/jpeg" style="display: none;">
                                    <button class="btn btn-secondary" onclick="document.getElementById('logo-uploader').click();">Escolher Imagem</button>
                                    <button class="btn btn-primary" id="save-logo-btn">üíæ Salvar Logo</button>
                                    <button class="btn btn-danger" id="delete-logo-btn">üóëÔ∏è Excluir Logo</button>
                                </div>
                            </div>
                            <div id="logo-feedback" class="feedback-message" style="display: none;"></div>
                        </div>

                        <!-- Se√ß√£o: Tempo de Expira√ß√£o de OS -->
                        <div id="os-expiration-config-section" class="settings-section form-panel">
                            <h3>‚è∞ Tempo de Expira√ß√£o de Ordens de Servi√ßo</h3>
                            <p>Configure o tempo limite para que ordens de servi√ßo antigas n√£o apare√ßam mais na busca. O tempo √© contado a partir da data de entrega prevista.</p>
                            
                            <div class="expiration-config-container">
                                <div class="form-group">
                                    <label class="checkbox-container">
                                        <input type="checkbox" id="enable-os-expiration" checked>
                                        <span class="checkmark"></span>
                                        Ativar filtro de tempo de expira√ß√£o
                                    </label>
                                    <small class="input-hint">Quando ativado, ordens de servi√ßo antigas n√£o aparecer√£o na busca</small>
                                </div>
                                
                                <div class="form-group" id="expiration-time-group">
                                    <label for="os-expiration-months">Tempo de expira√ß√£o (em meses):</label>
                                    <select id="os-expiration-months" class="form-control">
                                        <option value="2">2 meses</option>
                                        <option value="3" selected>3 meses</option>
                                        <option value="4">4 meses</option>
                                        <option value="5">5 meses</option>
                                        <option value="6">6 meses</option>
                                        <option value="7">7 meses</option>
                                        <option value="8">8 meses</option>
                                        <option value="9">9 meses</option>
                                        <option value="10">10 meses</option>
                                        <option value="11">11 meses</option>
                                        <option value="12">12 meses</option>
                                    </select>
                                    <small class="input-hint">Ordens de servi√ßo com data de entrega prevista superior ao tempo selecionado n√£o aparecer√£o na busca</small>
                                </div>
                                
                                <div class="form-actions">
                                    <button type="button" id="save-expiration-config" class="btn btn-primary">
                                        üíæ Salvar Configura√ß√£o
                                    </button>
                                </div>
                                
                                <div id="expiration-feedback" class="feedback-message" style="display: none;"></div>
                            </div>
                        </div>

                        <!-- Se√ß√£o: Gerenciar Banner Principal -->
                        <div id="banner-management-section" class="settings-section form-panel" style="display: none;">
                            <h3>üé® Gerenciar Banner Principal</h3>
                            <p>Configure o banner que aparece na p√°gina inicial do site.</p>
                            
                            <div class="banner-management-container">
                                <!-- Header com Controles -->
                                <div class="banner-header">
                                    <div class="banner-title-section">
                                        <h3>üé® Gerenciar Banner Principal</h3>
                                        <p>Configure os slides do carousel da p√°gina inicial</p>
                                    </div>
                                    <div class="banner-controls">
                                        <button id="add-banner-slide" class="btn btn-success">
                                            <span class="btn-icon">‚ûï</span>
                                            Adicionar Slide
                                        </button>
                                        <span class="slide-counter">
                                            <span id="current-slides-count">3</span> slides
                                        </span>
                                    </div>
                                </div>

                                <!-- Abas dos Slides -->
                                <div class="banner-tabs" id="banner-tabs-container">
                                    <button class="banner-tab active" data-slide="0">üì± Slide 1 - Tela Quebrada</button>
                                    <button class="banner-tab" data-slide="1">üîß Slide 2 - Reparo de Placa</button>
                                    <button class="banner-tab" data-slide="2">üîã Slide 3 - Bateria</button>
                                </div>

                                <!-- Conte√∫do dos Slides -->
                                <div class="banner-slide-content" id="banner-slides-container">
                                    <div class="banner-slide-editor active" data-slide="0">
                                        <!-- T√≠tulo Principal -->
                                        <div class="modern-form-section">
                                            <div class="form-section-header">
                                                <span class="section-icon">üéØ</span>
                                                <h4>T√≠tulo Principal</h4>
                                                <small>O t√≠tulo chamativo que aparece no banner</small>
                                            </div>
                                            <div class="enhanced-input-group">
                                                <input type="text" id="slide-0-title" placeholder="Ex: Tela Quebrada? Resolvemos na Hora." class="enhanced-input">
                                                <div class="input-helper">
                                                    <span class="char-counter" data-target="slide-0-title">0/80</span>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Descri√ß√£o -->
                                        <div class="modern-form-section">
                                            <div class="form-section-header">
                                                <span class="section-icon">üìù</span>
                                                <h4>Descri√ß√£o do Servi√ßo</h4>
                                                <small>Texto explicativo que convence o cliente</small>
                                            </div>
                                            <div class="enhanced-input-group">
                                                <textarea id="slide-0-description" rows="4" placeholder="Ex: Reparo de telas de todas as marcas com pe√ßas de alta qualidade e garantia. Seu celular novo de novo!" class="enhanced-textarea"></textarea>
                                                <div class="input-helper">
                                                    <span class="char-counter" data-target="slide-0-description">0/200</span>
                                                    <div class="writing-tips">
                                                        <span class="tip">üí° Dica: Mencione qualidade, rapidez e garantia</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Bot√£o de A√ß√£o -->
                                        <div class="modern-form-section">
                                            <div class="form-section-header">
                                                <span class="section-icon">üîó</span>
                                                <h4>Bot√£o de A√ß√£o</h4>
                                                <small>Como o cliente pode entrar em contato</small>
                                            </div>
                                            <div class="button-config-grid">
                                                <div class="enhanced-input-group">
                                                    <label class="input-label">Texto do Bot√£o</label>
                                                    <input type="text" id="slide-0-button" placeholder="Ex: Ver Servi√ßos de Tela" class="enhanced-input">
                                                    <div class="input-suggestions">
                                                        <button type="button" class="suggestion-btn" data-value="Ver Servi√ßos">Ver Servi√ßos</button>
                                                        <button type="button" class="suggestion-btn" data-value="Solicitar Or√ßamento">Solicitar Or√ßamento</button>
                                                        <button type="button" class="suggestion-btn" data-value="Entre em Contato">Entre em Contato</button>
                                                    </div>
                                                </div>
                                                <div class="enhanced-input-group">
                                                    <label class="input-label">Link de Destino</label>
                                                    <select id="slide-0-link" class="enhanced-select">
                                                        <option value="servicos.html">üìã P√°gina de Servi√ßos</option>
                                                        <option value="contato.html">üìû P√°gina de Contato</option>
                                                        <option value="auth.html">üë§ √Årea do Cliente</option>
                                                        <option value="#whatsapp">üí¨ WhatsApp Direto</option>
                                                        <option value="custom">üîó Link Personalizado</option>
                                                    </select>
                                                    <input type="text" id="slide-0-link-custom" placeholder="Digite o link personalizado" class="enhanced-input custom-link-input" style="display: none;">
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Imagem de Fundo -->
                                        <div class="modern-form-section">
                                            <div class="form-section-header">
                                                <span class="section-icon">üñºÔ∏è</span>
                                                <h4>Imagem de Fundo</h4>
                                                <small>Imagem que aparece atr√°s do texto (recomendado: 1200x600px)</small>
                                            </div>
                                            <div class="enhanced-image-upload">
                                                <div class="image-preview-container">
                                                    <img id="slide-0-preview" src="logos/1.png" alt="Preview Slide 1" class="image-preview">
                                                    <div class="image-overlay">
                                                        <div class="image-info">
                                                            <span class="image-size" id="slide-0-size">Imagem Atual</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="image-upload-actions">
                                                    <input type="file" id="slide-0-uploader" accept="image/*" style="display: none;">
                                                    <button type="button" class="btn btn-upload" onclick="document.getElementById('slide-0-uploader').click();">
                                                        <span class="btn-icon">üìÅ</span>
                                                        Escolher Nova Imagem
                                                    </button>
                                                    <div class="upload-guidelines">
                                                        <span>‚úì JPG, PNG ou WebP</span>
                                                        <span>‚úì M√°ximo 5MB</span>
                                                        <span>‚úì Ideal: 1200x600px</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="banner-slide-editor" data-slide="1">
                                        <!-- T√≠tulo Principal -->
                                        <div class="modern-form-section">
                                            <div class="form-section-header">
                                                <span class="section-icon">üéØ</span>
                                                <h4>T√≠tulo Principal</h4>
                                                <small>O t√≠tulo chamativo que aparece no banner</small>
                                            </div>
                                            <div class="enhanced-input-group">
                                                <input type="text" id="slide-1-title" placeholder="Ex: Especialistas em Reparo de Placa" class="enhanced-input">
                                                <div class="input-helper">
                                                    <span class="char-counter" data-target="slide-1-title">0/80</span>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Descri√ß√£o -->
                                        <div class="modern-form-section">
                                            <div class="form-section-header">
                                                <span class="section-icon">üìù</span>
                                                <h4>Descri√ß√£o do Servi√ßo</h4>
                                                <small>Texto explicativo que convence o cliente</small>
                                            </div>
                                            <div class="enhanced-input-group">
                                                <textarea id="slide-1-description" rows="4" placeholder="Ex: An√°lise e reparo de placas com tecnologia de ponta. N√£o desista do seu aparelho!" class="enhanced-textarea"></textarea>
                                                <div class="input-helper">
                                                    <span class="char-counter" data-target="slide-1-description">0/200</span>
                                                    <div class="writing-tips">
                                                        <span class="tip">üí° Dica: Foque na especializa√ß√£o t√©cnica</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Bot√£o de A√ß√£o -->
                                        <div class="modern-form-section">
                                            <div class="form-section-header">
                                                <span class="section-icon">üîó</span>
                                                <h4>Bot√£o de A√ß√£o</h4>
                                                <small>Como o cliente pode entrar em contato</small>
                                            </div>
                                            <div class="button-config-grid">
                                                <div class="enhanced-input-group">
                                                    <label class="input-label">Texto do Bot√£o</label>
                                                    <input type="text" id="slide-1-button" placeholder="Ex: Saiba Mais sobre Reparos" class="enhanced-input">
                                                    <div class="input-suggestions">
                                                        <button type="button" class="suggestion-btn" data-value="Saiba Mais sobre Reparos">Saiba Mais sobre Reparos</button>
                                                        <button type="button" class="suggestion-btn" data-value="Reparo de Placa">Reparo de Placa</button>
                                                        <button type="button" class="suggestion-btn" data-value="Diagn√≥stico Gratuito">Diagn√≥stico Gratuito</button>
                                                    </div>
                                                </div>
                                                <div class="enhanced-input-group">
                                                    <label class="input-label">Link de Destino</label>
                                                    <select id="slide-1-link" class="enhanced-select">
                                                        <option value="servicos.html">üìã P√°gina de Servi√ßos</option>
                                                        <option value="contato.html">üìû P√°gina de Contato</option>
                                                        <option value="auth.html">üë§ √Årea do Cliente</option>
                                                        <option value="#whatsapp">üí¨ WhatsApp Direto</option>
                                                        <option value="custom">üîó Link Personalizado</option>
                                                    </select>
                                                    <input type="text" id="slide-1-link-custom" placeholder="Digite o link personalizado" class="enhanced-input custom-link-input" style="display: none;">
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Imagem de Fundo -->
                                        <div class="modern-form-section">
                                            <div class="form-section-header">
                                                <span class="section-icon">üñºÔ∏è</span>
                                                <h4>Imagem de Fundo</h4>
                                                <small>Imagem que aparece atr√°s do texto (recomendado: 1200x600px)</small>
                                            </div>
                                            <div class="enhanced-image-upload">
                                                <div class="image-preview-container">
                                                    <img id="slide-1-preview" src="logos/2.png" alt="Preview Slide 2" class="image-preview">
                                                    <div class="image-overlay">
                                                        <div class="image-info">
                                                            <span class="image-size" id="slide-1-size">Imagem Atual</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="image-upload-actions">
                                                    <input type="file" id="slide-1-uploader" accept="image/*" style="display: none;">
                                                    <button type="button" class="btn btn-upload" onclick="document.getElementById('slide-1-uploader').click();">
                                                        <span class="btn-icon">üìÅ</span>
                                                        Escolher Nova Imagem
                                                    </button>
                                                    <div class="upload-guidelines">
                                                        <span>‚úì JPG, PNG ou WebP</span>
                                                        <span>‚úì M√°ximo 5MB</span>
                                                        <span>‚úì Ideal: 1200x600px</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="banner-slide-editor" data-slide="2">
                                        <!-- T√≠tulo Principal -->
                                        <div class="modern-form-section">
                                            <div class="form-section-header">
                                                <span class="section-icon">üéØ</span>
                                                <h4>T√≠tulo Principal</h4>
                                                <small>O t√≠tulo chamativo que aparece no banner</small>
                                            </div>
                                            <div class="enhanced-input-group">
                                                <input type="text" id="slide-2-title" placeholder="Ex: Bateria Nova, Vida Nova" class="enhanced-input">
                                                <div class="input-helper">
                                                    <span class="char-counter" data-target="slide-2-title">0/80</span>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Descri√ß√£o -->
                                        <div class="modern-form-section">
                                            <div class="form-section-header">
                                                <span class="section-icon">üìù</span>
                                                <h4>Descri√ß√£o do Servi√ßo</h4>
                                                <small>Texto explicativo que convence o cliente</small>
                                            </div>
                                            <div class="enhanced-input-group">
                                                <textarea id="slide-2-description" rows="4" placeholder="Ex: Troca de baterias com agilidade para seu celular durar o dia todo." class="enhanced-textarea"></textarea>
                                                <div class="input-helper">
                                                    <span class="char-counter" data-target="slide-2-description">0/200</span>
                                                    <div class="writing-tips">
                                                        <span class="tip">üí° Dica: Enfatize rapidez e durabilidade</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Bot√£o de A√ß√£o -->
                                        <div class="modern-form-section">
                                            <div class="form-section-header">
                                                <span class="section-icon">üîó</span>
                                                <h4>Bot√£o de A√ß√£o</h4>
                                                <small>Como o cliente pode entrar em contato</small>
                                            </div>
                                            <div class="button-config-grid">
                                                <div class="enhanced-input-group">
                                                    <label class="input-label">Texto do Bot√£o</label>
                                                    <input type="text" id="slide-2-button" placeholder="Ex: Or√ßamento para Bateria" class="enhanced-input">
                                                    <div class="input-suggestions">
                                                        <button type="button" class="suggestion-btn" data-value="Or√ßamento para Bateria">Or√ßamento para Bateria</button>
                                                        <button type="button" class="suggestion-btn" data-value="Trocar Bateria">Trocar Bateria</button>
                                                        <button type="button" class="suggestion-btn" data-value="Teste de Bateria">Teste de Bateria</button>
                                                    </div>
                                                </div>
                                                <div class="enhanced-input-group">
                                                    <label class="input-label">Link de Destino</label>
                                                    <select id="slide-2-link" class="enhanced-select">
                                                        <option value="servicos.html">üìã P√°gina de Servi√ßos</option>
                                                        <option value="contato.html">üìû P√°gina de Contato</option>
                                                        <option value="auth.html">üë§ √Årea do Cliente</option>
                                                        <option value="#whatsapp">üí¨ WhatsApp Direto</option>
                                                        <option value="custom">üîó Link Personalizado</option>
                                                    </select>
                                                    <input type="text" id="slide-2-link-custom" placeholder="Digite o link personalizado" class="enhanced-input custom-link-input" style="display: none;">
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Imagem de Fundo -->
                                        <div class="modern-form-section">
                                            <div class="form-section-header">
                                                <span class="section-icon">üñºÔ∏è</span>
                                                <h4>Imagem de Fundo</h4>
                                                <small>Imagem que aparece atr√°s do texto (recomendado: 1200x600px)</small>
                                            </div>
                                            <div class="enhanced-image-upload">
                                                <div class="image-preview-container">
                                                    <img id="slide-2-preview" src="logos/3.png" alt="Preview Slide 3" class="image-preview">
                                                    <div class="image-overlay">
                                                        <div class="image-info">
                                                            <span class="image-size" id="slide-2-size">Imagem Atual</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="image-upload-actions">
                                                    <input type="file" id="slide-2-uploader" accept="image/*" style="display: none;">
                                                    <button type="button" class="btn btn-upload" onclick="document.getElementById('slide-2-uploader').click();">
                                                        <span class="btn-icon">üìÅ</span>
                                                        Escolher Nova Imagem
                                                    </button>
                                                    <div class="upload-guidelines">
                                                        <span>‚úì JPG, PNG ou WebP</span>
                                                        <span>‚úì M√°ximo 5MB</span>
                                                        <span>‚úì Ideal: 1200x600px</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- A√ß√µes -->
                                <div class="banner-actions">
                                    <button type="button" class="btn btn-primary" id="save-banner-btn">üíæ Salvar Altera√ß√µes</button>
                                    <button type="button" class="btn btn-secondary" id="preview-banner-btn">üëÅÔ∏è Visualizar no Site</button>
                                    <button type="button" class="btn btn-danger" id="reset-banner-btn">üîÑ Restaurar Padr√£o</button>
                                </div>

                                <div id="banner-feedback" class="feedback-message" style="display: none;"></div>
                            </div>
                        </div>

                        <!-- Se√ß√£o: Gerenciamento de Lojas -->
                        <div id="stores-management-section" class="settings-section form-panel" style="display: none;">
                            <h3>Gerenciar Lojas</h3>
                            <!-- ... (CRUD de Lojas) ... -->
                        </div>



                    </div>
                </div>

                <!-- M√≥dulo: Trocar Senha -->
                <div id="module-trocar-senha" class="module-page" style="display: none;">
                    <div class="module-header">
                        <h1>üîí Trocar Senha</h1>
                        <p class="module-description">Mantenha sua conta segura alterando sua senha regularmente.</p>
                    </div>
                    
                    <div class="password-change-section">
                        <div class="password-form-container">
                            <form id="change-password-form" class="modern-form">
                                <div class="form-group password-input-group">
                                    <label for="current-password">
                                        <span class="label-icon">üîí</span>
                                        Senha Atual
                                    </label>
                                    <div class="input-with-icon">
                                        <input type="password" id="current-password" required placeholder="Digite sua senha atual">
                                        <button type="button" class="password-toggle-btn" data-target="current-password">
                                            <span class="toggle-icon">üëÅÔ∏è</span>
                                        </button>
                                    </div>
                                    <small class="input-hint">Para confirmar sua identidade</small>
                                </div>
                                
                                <div class="form-group password-input-group">
                                    <label for="new-password">
                                        <span class="label-icon">üîë</span>
                                        Nova Senha
                                    </label>
                                    <div class="input-with-icon">
                                        <input type="password" id="new-password" required minlength="6" placeholder="Digite sua nova senha">
                                        <button type="button" class="password-toggle-btn" data-target="new-password">
                                            <span class="toggle-icon">üëÅÔ∏è</span>
                                        </button>
                                    </div>
                                    <small class="input-hint">M√≠nimo de 6 caracteres</small>
                                </div>
                                
                                <div class="form-group password-input-group">
                                    <label for="confirm-password">
                                        <span class="label-icon">üîê</span>
                                        Confirmar Nova Senha
                                    </label>
                                    <div class="input-with-icon">
                                        <input type="password" id="confirm-password" required minlength="6" placeholder="Digite novamente sua nova senha">
                                        <button type="button" class="password-toggle-btn" data-target="confirm-password">
                                            <span class="toggle-icon">üëÅÔ∏è</span>
                                        </button>
                                    </div>
                                    <small class="input-hint">Deve ser igual √† senha anterior</small>
                                </div>
                                
                                <div class="password-requirements">
                                    <h4>Requisitos da Senha:</h4>
                                    <ul class="requirements-list">
                                        <li id="req-length">‚úì Pelo menos 6 caracteres</li>
                                        <li id="req-match">‚úì Senhas devem coincidir</li>
                                        <li id="req-different">‚úì Deve ser diferente da senha atual</li>
                                    </ul>
                                </div>
                                
                                <div class="form-actions">
                                    <button type="submit" class="btn btn-primary btn-large">
                                        üîí Alterar Senha
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- M√≥dulo: Usu√°rios e Permiss√µes -->
                <div id="module-usuarios-permissoes" class="module-page" style="display: none;">
                    <div class="module-header">
                        <h1>üë• Usu√°rios e Permiss√µes</h1>
                        <p class="module-description">Gerencie usu√°rios do sistema e suas permiss√µes de acesso.</p>
                    </div>
                    
                    <div class="users-management-container">
                        <div class="module-actions">
                            <button id="btn-create-user" class="btn btn-primary">
                                <span class="btn-icon">‚ûï</span>
                                Criar Novo Usu√°rio
                            </button>
                        </div>
                        
                        <div class="users-content form-panel">
                            <h3>Lista de Usu√°rios</h3>
                            <div id="users-list-container">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>Nome</th>
                                            <th>Email</th>
                                            <th>Fun√ß√£o</th>
                                            <th>A√ß√µes</th>
                                        </tr>
                                    </thead>
                                    <tbody id="user-permissions-list-body">
                                        <!-- Usuarios ser√£o carregados aqui -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>



                            </div>
        </main>
                        </div>

    <!-- MODAL DA NOVA ORDEM DE SERVI√áO -->
    <div id="os-modal-container" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="os-modal-title">Nova Ordem de Servi√ßo</h2>
                <button id="btn-close-os-modal" class="close-modal-btn">&times;</button>
            </div>
            <div class="modal-body">
                <form id="new-os-form" class="os-form" novalidate>
                    <input type="hidden" id="os-edit-id">
                    <!-- Se√ß√£o do Cliente com busca -->
                    <fieldset>
                        <legend>1. Cliente</legend>
                        <div class="form-group autocomplete-container">
                            <label>Buscar Cliente Existente</label>
                            <input type="text" id="os-customer-search" placeholder="Digite o nome para buscar...">
                            <div id="os-customer-results" class="autocomplete-results"></div>
                        </div>
                        <input type="hidden" id="os-selected-customer-id">
                        
                        <div id="new-customer-os-form" style="display: none; margin-top: 15px;">
                            <h4 style="color: var(--primary-color); margin-bottom: 15px;">üìù Dados do Novo Cliente</h4>
                            
                            <!-- Informa√ß√µes B√°sicas -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Nome Completo *</label>
                                    <input type="text" id="os-new-customer-name" required>
                                </div>
                                <div class="form-group">
                                    <label>Telefone</label>
                                    <input type="tel" id="os-new-customer-phone" placeholder="(XX) XXXXX-XXXX">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Data de Nascimento</label>
                                    <input type="date" id="os-new-customer-birth-date">
                                </div>
                                <div class="form-group">
                                    <label>CEP</label>
                                    <input type="text" id="os-new-customer-zip" placeholder="00000-000">
                                </div>
                            </div>
                            
                            <!-- Endere√ßo -->
                            <div class="form-row">
                                <div class="form-group" style="flex: 3;">
                                    <label>Logradouro (Rua, Av.)</label>
                                    <input type="text" id="os-new-customer-street">
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label>N√∫mero</label>
                                    <input type="text" id="os-new-customer-number">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Bairro</label>
                                    <input type="text" id="os-new-customer-neighborhood">
                                </div>
                                <div class="form-group">
                                    <label>Cidade</label>
                                    <input type="text" id="os-new-customer-city">
                                </div>
                                <div class="form-group" style="flex: 0.5;">
                                    <label>Estado</label>
                                    <input type="text" id="os-new-customer-state" placeholder="UF" maxlength="2">
                                </div>
                            </div>
                            
                            <small style="color: var(--medium-gray); font-style: italic;">
                                * Os dados do cliente ser√£o salvos automaticamente ao criar a OS
                            </small>
                        </div>
                        <button type="button" id="btn-open-new-customer-modal" class="btn btn-secondary btn-sm">üë§ N√£o encontrou? Cadastrar novo cliente</button>
                    </fieldset>
                    <!-- Se√ß√£o do Equipamento -->
                    <fieldset><legend>2. Equipamento e Defeito</legend>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Marca *</label>
                                <input type="text" id="os-brand" placeholder="Digite a marca do equipamento" required>
                            </div>
                                                    <div class="form-group"><label>Modelo *</label><input type="text" id="os-model" required></div>
                        <div class="form-group"><label>Cor *</label><input type="text" id="os-color" required></div>
                        </div>
                        <div class="form-group"><label>Defeito Apresentado *</label><textarea id="os-problem" rows="3" required></textarea></div>
                        <div class="form-row">
                             <div class="form-group">
                                <label>Senha (Num√©rica/Texto)</label>
                                <input type="text" id="os-password">
                            </div>
                            <div class="form-group">
                                <label>Senha Padr√£o (Desenho)</label>
                                <div id="pattern-lock-container">
                                    <canvas id="pattern-lock-canvas" width="180" height="180"></canvas>
                                    <input type="hidden" id="os-pattern-lock-value">
                                </div>
                                <button type="button" id="btn-reset-pattern" class="btn btn-secondary btn-sm">Limpar Padr√£o</button>
                            </div>
                        </div>
                    </fieldset>
                    <!-- Se√ß√£o de Checklist -->
                    <fieldset>
                         <legend>3. üìã Checklist de Itens e Acess√≥rios</legend>
                         <p class="checklist-description">Marque os itens que <strong>acompanham</strong> o equipamento:</p>
                         
                         <div class="modern-checklist-grid">
                            <div class="modern-checklist-item">
                                <div class="checklist-icon">üîã</div>
                                <div class="checklist-content">
                                    <h4>Bateria</h4>
                                    <p>Bateria original ou compat√≠vel</p>
                                    <div class="toggle-switch-group">
                                        <label class="toggle-switch">
                                            <input type="radio" name="check-bateria" value="sim">
                                            <span class="toggle-slider yes">‚úì Sim</span>
                                        </label>
                                        <label class="toggle-switch">
                                            <input type="radio" name="check-bateria" value="nao" checked>
                                            <span class="toggle-slider no">‚úó N√£o</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="modern-checklist-item">
                                <div class="checklist-icon">üì±</div>
                                <div class="checklist-content">
                                    <h4>Chip/SIM Card</h4>
                                    <p>Cart√£o SIM do cliente</p>
                                    <div class="toggle-switch-group">
                                        <label class="toggle-switch">
                                            <input type="radio" name="check-chip" value="sim">
                                            <span class="toggle-slider yes">‚úì Sim</span>
                                        </label>
                                        <label class="toggle-switch">
                                            <input type="radio" name="check-chip" value="nao" checked>
                                            <span class="toggle-slider no">‚úó N√£o</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="modern-checklist-item">
                                <div class="checklist-icon">üîå</div>
                                <div class="checklist-content">
                                    <h4>Carregador</h4>
                                    <p>Cabo USB e/ou fonte</p>
                                    <div class="toggle-switch-group">
                                        <label class="toggle-switch">
                                            <input type="radio" name="check-carregador" value="sim">
                                            <span class="toggle-slider yes">‚úì Sim</span>
                                        </label>
                                        <label class="toggle-switch">
                                            <input type="radio" name="check-carregador" value="nao" checked>
                                            <span class="toggle-slider no">‚úó N√£o</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="modern-checklist-item">
                                <div class="checklist-icon">üì¶</div>
                                <div class="checklist-content">
                                    <h4>Carca√ßa/Apar√™ncia</h4>
                                    <p>Arranh√µes ou danos vis√≠veis</p>
                                    <div class="toggle-switch-group">
                                        <label class="toggle-switch">
                                            <input type="radio" name="check-aranhado" value="sim">
                                            <span class="toggle-slider damage">‚ö†Ô∏è Com Danos</span>
                                        </label>
                                        <label class="toggle-switch">
                                            <input type="radio" name="check-aranhado" value="nao" checked>
                                            <span class="toggle-slider good">‚úì Perfeita</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="modern-checklist-item">
                                <div class="checklist-icon">üéß</div>
                                <div class="checklist-content">
                                    <h4>Fone de Ouvido</h4>
                                    <p>Fones ou earbuds</p>
                                    <div class="toggle-switch-group">
                                        <label class="toggle-switch">
                                            <input type="radio" name="check-fone" value="sim">
                                            <span class="toggle-slider yes">‚úì Sim</span>
                                        </label>
                                        <label class="toggle-switch">
                                            <input type="radio" name="check-fone" value="nao" checked>
                                            <span class="toggle-slider no">‚úó N√£o</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="modern-checklist-item">
                                <div class="checklist-icon">üõ°Ô∏è</div>
                                <div class="checklist-content">
                                    <h4>Capinha/Case</h4>
                                    <p>Prote√ß√£o externa</p>
                                    <div class="toggle-switch-group">
                                        <label class="toggle-switch">
                                            <input type="radio" name="check-capinha" value="sim">
                                            <span class="toggle-slider yes">‚úì Sim</span>
                                        </label>
                                        <label class="toggle-switch">
                                            <input type="radio" name="check-capinha" value="nao" checked>
                                            <span class="toggle-slider no">‚úó N√£o</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="checklist-footer">
                            <p><strong>üìù Importante:</strong> Itens marcados como "Sim" ser√£o devolvidos junto com o equipamento.</p>
                        </div>
                    </fieldset>
                     <!-- Se√ß√£o de Or√ßamento -->
                    <fieldset><legend>4. Or√ßamento</legend>
                    <!-- Se√ß√£o de Produtos do Estoque -->
                    <fieldset>
                        <legend>Produtos Utilizados na OS</legend>
                        <div class="form-group autocomplete-container">
                            <label>Buscar Produto no Estoque</label>
                            <input type="text" id="os-product-search" placeholder="Digite para buscar...">
                            <div id="os-product-results" class="autocomplete-results"></div>
                        </div>
                        <div id="os-products-list">
                            <!-- Produtos adicionados ser√£o listados aqui -->
                            </div>
                        </fieldset>

                        <div class="form-row">
                             <div class="form-group"><label>Valor (R$) *</label><input type="text" id="os-quote-value" placeholder="Ex: 1.500,00" required></div>
                             <div class="form-group"><label>Status Pagamento</label><select id="os-payment-status"><option value="Pendente">Pendente</option><option value="Parcial">Parcial</option><option value="Pago">Pago</option></select></div>
                            <div class="form-group" id="os-amount-paid-group" style="display:none;">
                                <label>Valor Pago (R$)</label>
                                <input type="text" id="os-amount-paid" placeholder="Ex: 750,00" style="background: yellow !important; z-index: 9999 !important; position: relative !important;">
                                <!-- Campo de teste para debug -->
                                <input type="text" id="test-input" placeholder="Teste de digita√ß√£o" style="margin-top: 5px; border: 2px solid red;">
                            </div>
                        </div>
                    </fieldset>

                     <!-- Se√ß√£o Final -->
                     <fieldset><legend>5. Detalhes Finais</legend>
                         <div class="form-row">
                            <div class="form-group">
                                <label>Status da OS</label>
                                <select id="os-status">
                                    <option value="">Selecione o status...</option>
                                    <option value="pending">Pendente</option>
                                    <option value="progress" selected>Em Concerto</option>
                                    <option value="awaiting_pickup">Aguardando Retirada</option>
                                    <option value="delivered">Entregue</option>
                                    <option value="cancelled">Cancelada</option>
                                </select>
                            </div>
                             <div class="form-group">
                                <label>Previs√£o de Entrega *</label>
                                <input type="datetime-local" id="os-delivery-date" required>
                             </div>
                         </div>
                         <div class="form-group"><label>Observa√ß√µes</label><textarea id="os-notes" rows="2"></textarea></div>
                        <div class="os-disclaimer"><p><strong>Aviso:</strong> Ap√≥s aprovado o or√ßamento,o servi√ßo s√≥ ser√° realizado mediante o pagamento de 50% do servi√ßo solicitado, caso o mesmo n√£o venha retirar o aparelho ap√≥s 90 dias ser√° cobrado um valor di√°rio de R$2,00 (dois reais), e passado 180 dias o mesmo ser√° vendido ou sucateado para cobrir custos e despesas tais como, m√£o de obra ou pe√ßas substituidas.</p></div>
                     </fieldset>
                    <div class="form-actions modal-actions"><button type="submit" class="btn btn-primary">üíæ Salvar OS</button></div>
                </form>
            </div>
        </div>
    </div>

    <!-- MODAL DE VISUALIZA√á√ÉO DA ORDEM DE SERVI√áO -->
    <div id="view-os-modal-container" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="view-os-modal-title">Detalhes da Ordem de Servi√ßo</h2>
                <button id="btn-close-view-os-modal" class="close-modal-btn">&times;</button>
            </div>
            <div id="view-os-modal-body" class="modal-body">
                <!-- Informa√ß√µes da OS -->
                <div class="os-view-section">
                    <h3>üìã Informa√ß√µes Gerais</h3>
                    <div class="os-view-grid">
                        <div class="os-view-item">
                            <label>ID da OS:</label>
                            <span id="view-os-id">-</span>
                        </div>
                        <div class="os-view-item">
                            <label>Status:</label>
                            <span id="view-os-status">-</span>
                        </div>
                        <div class="os-view-item">
                            <label>Data de Cria√ß√£o:</label>
                            <span id="view-os-created-at">-</span>
                        </div>
                        <div class="os-view-item">
                            <label>√öltima Atualiza√ß√£o:</label>
                            <span id="view-os-updated-at">-</span>
                        </div>
                    </div>
                </div>

                <!-- Informa√ß√µes do Cliente -->
                <div class="os-view-section">
                    <h3>üë§ Cliente</h3>
                    <div class="os-view-grid">
                        <div class="os-view-item">
                            <label>Nome:</label>
                            <span id="view-os-customer-name">-</span>
                        </div>
                        <div class="os-view-item">
                            <label>Telefone:</label>
                            <span id="view-os-customer-phone">-</span>
                        </div>
                        <div class="os-view-item full-width">
                            <label>Endere√ßo:</label>
                            <span id="view-os-customer-address">-</span>
                        </div>
                    </div>
                </div>

                <!-- Informa√ß√µes do Equipamento -->
                <div class="os-view-section">
                    <h3>üì± Equipamento</h3>
                    <div class="os-view-grid">
                        <div class="os-view-item">
                            <label>Marca:</label>
                            <span id="view-os-brand">-</span>
                        </div>
                        <div class="os-view-item">
                            <label>Modelo:</label>
                            <span id="view-os-model">-</span>
                        </div>
                        <div class="os-view-item">
                            <label>Cor:</label>
                            <span id="view-os-color">-</span>
                        </div>

                        <div class="os-view-item full-width">
                            <label>Problema Relatado:</label>
                            <span id="view-os-problem">-</span>
                        </div>
                        <div class="os-view-item full-width">
                            <label>Solu√ß√£o Aplicada:</label>
                            <span id="view-os-solution">-</span>
                        </div>
                    </div>
                </div>

                <!-- Senhas do Equipamento -->
                <div class="os-view-section" id="view-os-passwords-section">
                    <h3>üîí Senhas do Equipamento</h3>
                    <div class="os-view-grid">
                        <div class="os-view-item">
                            <label>Senha Num√©rica/Texto:</label>
                            <span id="view-os-numeric-password">N√£o informada</span>
                        </div>
                        <div class="os-view-item full-width" id="view-os-pattern-section" style="display: none;">
                            <label>Padr√£o de Desbloqueio:</label>
                            <div class="pattern-display-container">
                                <canvas id="view-pattern-canvas" width="120" height="120" style="border: 1px solid #ddd; border-radius: 8px; background: #f9f9f9;"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Informa√ß√µes Financeiras -->
                <div class="os-view-section">
                    <h3>üí∞ Or√ßamento e Pagamento</h3>
                    <div class="os-view-grid">
                        <div class="os-view-item">
                            <label>Valor do Or√ßamento:</label>
                            <span id="view-os-quote-value">-</span>
                        </div>
                        <div class="os-view-item">
                            <label>Valor Pago:</label>
                            <span id="view-os-amount-paid">-</span>
                        </div>

                        <div class="os-view-item">
                            <label>Previs√£o de Entrega:</label>
                            <span id="view-os-delivery-date">-</span>
                        </div>
                    </div>
                </div>

                <!-- Produtos Utilizados -->
                <div class="os-view-section">
                    <h3>üì¶ Produtos Utilizados</h3>
                    <div id="view-os-products-list">
                        <!-- Produtos ser√£o listados aqui -->
                    </div>
                </div>

                <!-- Observa√ß√µes -->
                <div class="os-view-section">
                    <h3>üìù Observa√ß√µes</h3>
                    <div class="os-view-notes">
                        <span id="view-os-notes">-</span>
                    </div>
                </div>

                <!-- Bot√µes de A√ß√£o -->
                <div class="os-view-actions">
                    <button id="btn-edit-os" class="btn btn-primary">‚úèÔ∏è Editar</button>
                    <button id="btn-delete-os" class="btn btn-danger">üóëÔ∏è Excluir</button>
                    <button id="btn-print-os" class="btn btn-secondary">üñ®Ô∏è Imprimir</button>
                    <button id="btn-mark-awaiting-pickup" class="btn btn-warning">üì¶ Aguardando Retirada</button>
                    <button id="btn-mark-delivered" class="btn btn-success">‚úÖ Marcar como Entregue</button>
                    <button id="btn-launch-to-cash" class="btn btn-info">üí∞ Lan√ßar no Caixa</button>
                </div>
            </div>
            <div class="modal-footer">
                <!-- Footer removido para evitar duplica√ß√£o do bot√£o imprimir -->
            </div>
        </div>
    </div>

    <!-- MODAL DE NOVA CATEGORIA -->
    <div id="category-modal-container" class="modal-overlay" style="display: none;">
        <div class="modal-content small-modal">
            <div class="modal-header">
                <h2>Nova Categoria</h2>
                <button id="btn-close-category-modal" class="close-modal-btn">&times;</button>
            </div>
            <div class="modal-body">
                <form id="new-category-form" class="os-form">
                    <div class="form-group">
                        <label>Nome da Categoria</label>
                        <input type="text" id="new-category-name" placeholder="Ex: Capas, Pel√≠culas..." required>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">üíæ Salvar Categoria</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- MODAL DE GERENCIAR CATEGORIAS -->
    <div id="manage-categories-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h2>üè∑Ô∏è Gerenciar Categorias</h2>
                <button id="btn-close-manage-categories-modal" class="close-modal-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="categories-management">
                    <div class="categories-header">
                        <p>Gerencie as categorias do seu estoque. <strong>Aten√ß√£o:</strong> Ao remover uma categoria, todos os produtos associados ficar√£o sem categoria.</p>
                        <button id="btn-add-new-category" class="btn btn-primary btn-sm">‚ûï Nova Categoria</button>
                    </div>
                    
                    <div class="categories-list">
                        <div class="categories-table-container">
                            <table class="os-table">
                                <thead>
                                    <tr>
                                        <th>Nome da Categoria</th>
                                        <th>Produtos Associados</th>
                                        <th>Editar</th>
                                        <th>A√ß√µes</th>
                                    </tr>
                                </thead>
                                <tbody id="categories-table-body">
                                    <!-- Categorias ser√£o carregadas aqui -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAIS DO M√ìDULO DE CAIXA -->
    <!-- Modal para Abrir Caixa -->
    <div id="open-cash-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content small-modal">
            <div class="modal-header"><h2>Abrir Caixa</h2><button class="close-modal-btn" data-modal="open-cash-modal">&times;</button></div>
            <div class="modal-body">
                <form id="open-cash-form">
                    <div class="form-group"><label>Valor Inicial</label><input type="number" id="opening-balance" placeholder="0.00" step="0.01" required></div>
                    <div class="form-actions"><button type="submit" class="btn btn-primary">Confirmar Abertura</button></div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal para Adicionar/Retirar Dinheiro -->
    <div id="money-entry-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content small-modal">
            <div class="modal-header"><h2 id="money-entry-title"></h2><button class="close-modal-btn" data-modal="money-entry-modal">&times;</button></div>
            <div class="modal-body">
                <form id="money-entry-form">
                    <input type="hidden" id="money-entry-type">
                    <div class="form-group"><label>Valor (R$)</label><input type="number" id="money-entry-amount" placeholder="0.00" step="0.01" required></div>
                    <div class="form-group"><label>Descri√ß√£o/Motivo</label><input type="text" id="money-entry-description" required></div>
                    <div class="form-actions"><button type="submit" class="btn btn-primary">Confirmar</button></div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal para Fechar Caixa -->
    <div id="close-cash-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header"><h2>Fechar Caixa</h2><button class="close-modal-btn" data-modal="close-cash-modal">&times;</button></div>
            <div class="modal-body">
                <div id="close-cash-summary"></div>
                <form id="close-cash-form">
                    <div class="form-group"><label>Valor Contado em Caixa (Dinheiro)</label><input type="text" id="counted-balance" placeholder="0,00" required></div>
                    <div class="form-group"><label>Observa√ß√µes de Fechamento</label><textarea id="closing-notes" rows="3"></textarea></div>
                    <div id="cash-difference-alert" class="feedback-message" style="display: none;"></div>
                    <div class="form-actions"><button type="submit" class="btn btn-danger">Confirmar Fechamento</button></div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal para Ver Detalhes do Caixa Fechado -->
    <div id="view-cash-details-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="view-cash-details-title">Detalhes do Caixa</h2>
                <button class="close-modal-btn" data-modal="view-cash-details-modal">&times;</button>
            </div>
            <div id="view-cash-details-body" class="modal-body">
                <!-- O conte√∫do dos detalhes ser√° inserido aqui -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="reopen-cash-btn" onclick="reopenCashRegister(this.getAttribute('data-cash-id'))">Reabrir Caixa para Corre√ß√£o</button>
            </div>
        </div>
    </div>

    <!-- Modal para Criar Novo Usu√°rio -->
    <div id="create-user-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Criar Novo Usu√°rio</h2>
                <button class="close-modal-btn" data-modal="create-user-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="create-user-form">
                    <div class="form-group">
                        <label>üë§ Nome Completo *</label>
                        <input type="text" id="new-user-full-name" placeholder="Digite o nome completo do usu√°rio" required>
                        <small class="input-hint">Nome que ser√° exibido no sistema</small>
                    </div>
                    <div class="form-group">
                        <label>üìß E-mail *</label>
                        <input type="email" id="new-user-email" placeholder="usuario@exemplo.com" required>
                        <small class="input-hint">E-mail ser√° usado para login no sistema</small>
                    </div>
                    <div class="form-group">
                        <label>üîí Senha Provis√≥ria *</label>
                        <input type="password" id="new-user-password" placeholder="M√≠nimo 6 caracteres" required minlength="6">
                        <small class="input-hint">O usu√°rio poder√° alterar ap√≥s o primeiro login</small>
                    </div>
                    <div class="form-group">
                        <label>üé≠ Fun√ß√£o Principal no Sistema</label>
                        <select id="new-user-system-role">
                            <option value="employee">üë∑ Funcion√°rio</option>
                            <option value="technician">üîß T√©cnico</option>
                            <option value="admin">üë®‚Äçüíº Administrador</option>
                            <option value="owner">üëë Dono</option>
                        </select>
                        <small class="input-hint">Define o n√≠vel de acesso geral no sistema</small>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">üíæ Criar e Salvar Usu√°rio</button>
                        <button type="button" class="btn btn-secondary close-modal-btn" data-modal="create-user-modal">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal para Editar Permiss√µes do Usu√°rio -->
    <div id="edit-permissions-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h2 id="edit-permissions-title">Editar Permiss√µes</h2>
                <button class="close-modal-btn" data-modal="edit-permissions-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="edit-permissions-form">
                    <input type="hidden" id="edit-permissions-user-id">
                    
                    <!-- Se√ß√£o de Fun√ß√£o do Sistema -->
                    <div class="user-role-section">
                        <h3>üë§ Fun√ß√£o no Sistema</h3>
                        <div class="form-group">
                            <label for="edit-user-role">Fun√ß√£o Principal</label>
                            <select id="edit-user-role" class="role-select">
                                <option value="employee">üë∑ Funcion√°rio</option>
                                <option value="technician">üîß T√©cnico</option>
                                <option value="admin">üë®‚Äçüíº Administrador</option>
                                <option value="owner">üëë Dono</option>
                            </select>
                            <small class="input-hint">A fun√ß√£o determina o n√≠vel de acesso geral no sistema</small>
                        </div>
                    </div>
                    
                    <!-- Se√ß√£o de Permiss√µes por Loja -->
                    <div class="user-permissions-section">
                        <h3>üè™ Permiss√µes por Loja</h3>
                        <p class="modal-subtitle">Marque as permiss√µes espec√≠ficas que o usu√°rio ter√° em cada loja.</p>
                        <div id="user-permissions-list" class="permissions-container">
                            <!-- As permiss√µes por loja ser√£o carregadas aqui no formato de grupos -->
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">üíæ Salvar Altera√ß√µes</button>
                        <button type="button" class="btn btn-secondary close-modal-btn" data-modal="edit-permissions-modal">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal de Confirma√ß√£o para Exclus√£o de Usu√°rio -->
    <div id="delete-user-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2>‚ö†Ô∏è Confirmar Exclus√£o</h2>
                <button class="close-modal-btn" data-modal="delete-user-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="warning-message">
                    <p><strong>Tem certeza que deseja excluir o usu√°rio?</strong></p>
                    <p id="delete-user-name" class="user-name-display"></p>
                    <div class="warning-details">
                        <p>‚ö†Ô∏è <strong>Esta a√ß√£o n√£o pode ser desfeita!</strong></p>
                        <p>Ao confirmar, ser√° removido:</p>
                        <ul>
                            <li>‚úó O perfil do usu√°rio</li>
                            <li>‚úó Todas as permiss√µes associadas</li>
                            <li>‚úó O acesso ao sistema</li>
                        </ul>
                    </div>
                </div>
                <div class="form-actions" style="margin-top: 20px;">
                    <button id="confirm-delete-user" class="btn btn-danger">üóëÔ∏è Sim, Excluir Usu√°rio</button>
                    <button class="btn btn-secondary close-modal-btn" data-modal="delete-user-modal">Cancelar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast de Notifica√ß√£o -->
    <div id="toast-notification" class="toast">
        <span id="toast-message"></span>
    </div>

    <!-- Modal de Pagamento Dividido PDV -->
    <div id="pdv-split-modal" class="modal" style="display:none;">
      <div class="modal-content" style="max-width:400px;margin:auto;">
        <h3>Meio de Pagamento</h3>
        <form id="pdv-split-form">
          <div style="margin-bottom:8px; display: flex; align-items: center;">
            <label style="flex:1.2; display: flex; align-items: center;"><i class="payment-icon money-icon"></i> Dinheiro:</label>
            <input type="number" id="split-dinheiro" min="0" step="0.01" placeholder="0,00" style="flex:1;" />
          </div>
          <div style="margin-bottom:8px; display: flex; align-items: center;">
            <label style="flex:1.2; display: flex; align-items: center;"><i class="payment-icon credit-icon"></i> Cart√£o Cr√©dito:</label>
            <input type="number" id="split-credito" min="0" step="0.01" placeholder="0,00" style="flex:1;" />
          </div>
          <div style="margin-bottom:8px; display: flex; align-items: center;">
            <label style="flex:1.2; display: flex; align-items: center;"><i class="payment-icon debit-icon"></i> Cart√£o D√©bito:</label>
            <input type="number" id="split-debito" min="0" step="0.01" placeholder="0,00" style="flex:1;" />
          </div>
          <div style="margin-bottom:8px; display: flex; align-items: center;">
            <label style="flex:1.2; display: flex; align-items: center;"><i class="payment-icon pix-icon"></i> PIX:</label>
            <input type="number" id="split-pix" min="0" step="0.01" placeholder="0,00" style="flex:1;" />
          </div>
          <div style="margin-bottom:12px;">
            <strong>Total da Venda: <span id="pdv-split-total">R$ 0,00</span></strong>
          </div>
          <button type="submit" class="btn btn-primary">Finalizar Venda</button>
          <button type="button" class="btn" onclick="document.getElementById('pdv-split-modal').style.display='none'">Cancelar</button>
        </form>
      </div>
    </div>

    <!-- Importa o componente de Senha por Desenho -->
    <script type="module" src="pattern-lock-local.js"></script>
    <script type="module" src="js/api/supabase.js"></script>
    <script type="module" src="main.js"></script>

    <script type="module">
        import { checkOSAccess } from './js/auth/auth.js';
        checkOSAccess();
    </script>

    <!-- ADICIONADO: Modal para Visualizar Detalhes da OS -->
    <div id="os-view-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="os-view-title">Detalhes da Ordem de Servi√ßo</h2>
                <button id="btn-close-os-view-modal" class="close-modal-btn">&times;</button>
            </div>
            <div id="os-view-body" class="modal-body">
                <!-- O conte√∫do ser√° preenchido dinamicamente -->
                <p>Carregando...</p>
            </div>
            <div class="modal-footer">
                <button id="btn-print-os-from-view" class="btn btn-secondary">Imprimir</button>
            </div>
        </div>
    </div>

    <!-- Modal de Venda Conclu√≠da -->
    <div id="sale-success-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content sale-success-modal">
            <div class="success-animation">
                <div class="checkmark-circle">
                    <div class="checkmark"></div>
                </div>
            </div>
            <div class="success-content">
                <h2 class="success-title">üéâ Venda Conclu√≠da!</h2>
                <p class="success-message">Sua venda foi processada com sucesso</p>
                <div class="sale-details">
                    <div class="detail-row">
                        <span class="detail-label">Total da Venda:</span>
                        <span class="detail-value" id="success-total">R$ 0,00</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Forma de Pagamento:</span>
                        <span class="detail-value" id="success-payment">-</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Data/Hora:</span>
                        <span class="detail-value" id="success-datetime">-</span>
                    </div>
                </div>
                <div class="success-actions">
                    <button id="btn-print-receipt" class="btn btn-secondary">
                        üñ®Ô∏è Imprimir Recibo
                    </button>
                    <button id="btn-new-sale" class="btn btn-primary">
                        ‚ûï Nova Venda
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL COMPLETO PARA EDITAR OS -->
    <div id="edit-os-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="os-edit-title">Editar Ordem de Servi√ßo</h2>
                <button id="btn-close-os-edit-modal" class="close-modal-btn">&times;</button>
            </div>
            <div class="modal-body">
                <form id="edit-os-form" class="os-form" novalidate>
                    <input type="hidden" id="edit-os-id">
                    
                    <!-- Se√ß√£o do Cliente com busca -->
                    <fieldset>
                        <legend>1. Cliente</legend>
                        <div class="form-group autocomplete-container">
                            <label>Buscar Cliente Existente</label>
                            <input type="text" id="edit-os-customer-search" placeholder="Digite o nome para buscar...">
                            <div id="edit-os-customer-results" class="autocomplete-results"></div>
                        </div>
                        <input type="hidden" id="edit-os-selected-customer-id">
                        <input type="hidden" id="edit-os-customer-id-input">
                        
                        <!-- Display do cliente selecionado -->
                        <div id="edit-os-customer-display" class="customer-display" style="display: none; margin-top: 10px; padding: 10px; background: #f5f5f5; border-radius: 5px;">
                            <strong>Cliente Selecionado:</strong> <span id="edit-os-customer-name-display">-</span><br>
                            <strong>Telefone:</strong> <span id="edit-os-customer-phone-display">-</span>
                        </div>
                        
                        <div id="edit-new-customer-os-form" style="display: none; margin-top: 15px;">
                            <h4 style="color: var(--primary-color); margin-bottom: 15px;">üìù Dados do Novo Cliente</h4>
                            
                            <!-- Informa√ß√µes B√°sicas -->
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Nome Completo *</label>
                                    <input type="text" id="edit-os-new-customer-name" required>
                                </div>
                                <div class="form-group">
                                    <label>Telefone</label>
                                    <input type="tel" id="edit-os-new-customer-phone" placeholder="(XX) XXXXX-XXXX">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Data de Nascimento</label>
                                    <input type="date" id="edit-os-new-customer-birth-date">
                                </div>
                                <div class="form-group">
                                    <label>CEP</label>
                                    <input type="text" id="edit-os-new-customer-zip" placeholder="00000-000">
                                </div>
                            </div>
                            
                            <!-- Endere√ßo -->
                            <div class="form-row">
                                <div class="form-group" style="flex: 3;">
                                    <label>Logradouro (Rua, Av.)</label>
                                    <input type="text" id="edit-os-new-customer-street">
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label>N√∫mero</label>
                                    <input type="text" id="edit-os-new-customer-number">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Bairro</label>
                                    <input type="text" id="edit-os-new-customer-neighborhood">
                                </div>
                                <div class="form-group">
                                    <label>Cidade</label>
                                    <input type="text" id="edit-os-new-customer-city">
                                </div>
                                <div class="form-group" style="flex: 0.5;">
                                    <label>Estado</label>
                                    <input type="text" id="edit-os-new-customer-state" placeholder="UF" maxlength="2">
                                </div>
                            </div>
                            
                            <small style="color: var(--medium-gray); font-style: italic;">
                                * Os dados do cliente ser√£o atualizados automaticamente ao salvar a OS
                            </small>
                        </div>
                        <button type="button" id="edit-btn-toggle-new-customer-form" class="btn btn-secondary btn-sm">Alterar dados do cliente</button>
                    </fieldset>

                    <!-- Se√ß√£o do Equipamento -->
                    <fieldset><legend>2. Equipamento e Defeito</legend>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Marca</label>
                                <input type="text" id="edit-os-brand" placeholder="Digite a marca do equipamento">
                            </div>
                            <div class="form-group"><label>Modelo</label><input type="text" id="edit-os-model" required></div>
                             <div class="form-group"><label>Cor</label><input type="text" id="edit-os-color"></div>
                        </div>

                        <div class="form-group"><label>Defeito Apresentado</label><textarea id="edit-os-problem" rows="3" required></textarea></div>
                        <div class="form-row">
                             <div class="form-group">
                                <label>Senha (Num√©rica/Texto)</label>
                                <input type="text" id="edit-os-password">
                            </div>
                            <div class="form-group">
                                <label>Senha Padr√£o (Desenho)</label>
                                <div id="edit-pattern-lock-container">
                                    <canvas id="edit-pattern-lock-canvas" width="180" height="180"></canvas>
                                    <input type="hidden" id="edit-os-pattern-lock-value">
                                </div>
                                <button type="button" id="edit-btn-reset-pattern" class="btn btn-secondary btn-sm">Limpar Padr√£o</button>
                            </div>
                        </div>
                    </fieldset>

                    <!-- Se√ß√£o de Checklist -->
                    <fieldset>
                         <legend>3. üìã Checklist de Itens e Acess√≥rios</legend>
                         <p class="checklist-description">Marque os itens que <strong>acompanham</strong> o equipamento:</p>
                         
                         <div class="modern-checklist-grid">
                            <div class="modern-checklist-item">
                                <div class="checklist-icon">üîã</div>
                                <div class="checklist-content">
                                    <h4>Bateria</h4>
                                    <p>Bateria original ou compat√≠vel</p>
                                    <div class="toggle-switch-group">
                                        <label class="toggle-switch">
                                            <input type="radio" name="edit-check-bateria" value="sim">
                                            <span class="toggle-slider yes">‚úì Sim</span>
                                        </label>
                                        <label class="toggle-switch">
                                            <input type="radio" name="edit-check-bateria" value="nao" checked>
                                            <span class="toggle-slider no">‚úó N√£o</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="modern-checklist-item">
                                <div class="checklist-icon">üì±</div>
                                <div class="checklist-content">
                                    <h4>Chip/SIM Card</h4>
                                    <p>Cart√£o SIM do cliente</p>
                                    <div class="toggle-switch-group">
                                        <label class="toggle-switch">
                                            <input type="radio" name="edit-check-chip" value="sim">
                                            <span class="toggle-slider yes">‚úì Sim</span>
                                        </label>
                                        <label class="toggle-switch">
                                            <input type="radio" name="edit-check-chip" value="nao" checked>
                                            <span class="toggle-slider no">‚úó N√£o</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="modern-checklist-item">
                                <div class="checklist-icon">üîå</div>
                                <div class="checklist-content">
                                    <h4>Carregador</h4>
                                    <p>Cabo USB e/ou fonte</p>
                                    <div class="toggle-switch-group">
                                        <label class="toggle-switch">
                                            <input type="radio" name="edit-check-carregador" value="sim">
                                            <span class="toggle-slider yes">‚úì Sim</span>
                                        </label>
                                        <label class="toggle-switch">
                                            <input type="radio" name="edit-check-carregador" value="nao" checked>
                                            <span class="toggle-slider no">‚úó N√£o</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="modern-checklist-item">
                                <div class="checklist-icon">üì¶</div>
                                <div class="checklist-content">
                                    <h4>Carca√ßa/Apar√™ncia</h4>
                                    <p>Arranh√µes ou danos vis√≠veis</p>
                                    <div class="toggle-switch-group">
                                        <label class="toggle-switch">
                                            <input type="radio" name="edit-check-aranhado" value="sim">
                                            <span class="toggle-slider damage">‚ö†Ô∏è Com Danos</span>
                                        </label>
                                        <label class="toggle-switch">
                                            <input type="radio" name="edit-check-aranhado" value="nao" checked>
                                            <span class="toggle-slider good">‚úì Perfeita</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="modern-checklist-item">
                                <div class="checklist-icon">üéß</div>
                                <div class="checklist-content">
                                    <h4>Fone de Ouvido</h4>
                                    <p>Fones ou earbuds</p>
                                    <div class="toggle-switch-group">
                                        <label class="toggle-switch">
                                            <input type="radio" name="edit-check-fone" value="sim">
                                            <span class="toggle-slider yes">‚úì Sim</span>
                                        </label>
                                        <label class="toggle-switch">
                                            <input type="radio" name="edit-check-fone" value="nao" checked>
                                            <span class="toggle-slider no">‚úó N√£o</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="modern-checklist-item">
                                <div class="checklist-icon">üõ°Ô∏è</div>
                                <div class="checklist-content">
                                    <h4>Capinha/Case</h4>
                                    <p>Prote√ß√£o externa</p>
                                    <div class="toggle-switch-group">
                                        <label class="toggle-switch">
                                            <input type="radio" name="edit-check-capinha" value="sim">
                                            <span class="toggle-slider yes">‚úì Sim</span>
                                        </label>
                                        <label class="toggle-switch">
                                            <input type="radio" name="edit-check-capinha" value="nao" checked>
                                            <span class="toggle-slider no">‚úó N√£o</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="checklist-footer">
                            <p><strong>üìù Importante:</strong> Itens marcados como "Sim" ser√£o devolvidos junto com o equipamento.</p>
                        </div>
                    </fieldset>

                     <!-- Se√ß√£o de Or√ßamento -->
                    <fieldset><legend>4. Or√ßamento</legend>
                        <div class="form-row">
                             <div class="form-group"><label>Valor (R$)</label><input type="text" id="edit-os-quote-value" placeholder="Ex: 1.500,00"></div>
                             <div class="form-group"><label>Status Pagamento</label><select id="edit-os-payment-status"><option value="Pendente">Pendente</option><option value="Parcial">Parcial</option><option value="Pago">Pago</option></select></div>
                            <div class="form-group" id="edit-os-amount-paid-group" style="display:none;"><label>Valor Pago (R$)</label><input type="text" id="edit-os-amount-paid" placeholder="Ex: 750,00"></div>
                        </div>

                    </fieldset>

                    <!-- Se√ß√£o de Produtos do Estoque -->
                    <fieldset>
                        <legend>Produtos Utilizados na OS</legend>
                        <div class="form-group autocomplete-container">
                            <label>Buscar Produto no Estoque</label>
                            <input type="text" id="edit-os-product-search" placeholder="Digite para buscar...">
                            <div id="edit-os-product-results" class="autocomplete-results"></div>
                        </div>
                        <div id="edit-os-products-list">
                            <!-- Produtos adicionados ser√£o listados aqui -->
                        </div>
                    </fieldset>

                     <!-- Se√ß√£o Final -->
                     <fieldset><legend>5. Detalhes Finais</legend>
                         <div class="form-group">
                             <label>Solu√ß√£o Aplicada</label>
                             <textarea id="edit-os-solution" rows="3" placeholder="Descreva a solu√ß√£o aplicada ao problema..."></textarea>
                         </div>
                         <div class="form-row">
                            <div class="form-group">
                                <label>Status da OS</label>
                                <select id="edit-os-status-select">
                                    <option value="">Selecione o status...</option>
                                    <option value="pending">Pendente</option>
                                    <option value="progress">Em Concerto</option>
                                    <option value="awaiting_pickup">Aguardando Retirada</option>
                                    <option value="delivered">Entregue</option>
                                    <option value="cancelled">Cancelada</option>
                                </select>
                            </div>
                             <div class="form-group">
                                <label>Previs√£o de Entrega</label>
                                <input type="datetime-local" id="edit-os-delivery-date">
                             </div>
                         </div>
                         <div class="form-group"><label>Observa√ß√µes</label><textarea id="edit-os-notes" rows="2"></textarea></div>
                        <div class="os-disclaimer"><p><strong>Aviso:</strong> Ap√≥s aprovado o or√ßamento,o servi√ßo s√≥ ser√° realizado mediante o pagamento de 50% do servi√ßo solicitado, caso o mesmo n√£o venha retirar o aparelho ap√≥s 90 dias ser√° cobrado um valor di√°rio de R$2,00 (dois reais), e passado 180 dias o mesmo ser√° vendido ou sucateado para cobrir custos e despesas tais como, m√£o de obra ou pe√ßas substituidas.</p></div>
                     </fieldset>

                    <div class="form-actions modal-actions">
                        <button type="button" id="btn-cancel-edit-os" class="btn btn-secondary">Cancelar</button>
                        <button type="submit" class="btn btn-primary">üíæ Salvar Altera√ß√µes</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div id="pdv-split-modal-backdrop" class="modal-backdrop" style="display: none;"></div>

    <!-- Modal para Adicionar Produto √† OS -->
    <div id="add-product-modal" class="modal-overlay">
        <div class="modal-content add-product-modal">
            <div class="modal-header">
                <h2>üõí Adicionar Produto √† OS</h2>
                <button class="close-modal-btn" onclick="closeAddProductModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="product-selection-info">
                    <div class="selected-product-card">
                        <div class="product-icon">üì¶</div>
                        <div class="product-details">
                            <h3 id="selected-product-name">Nome do Produto</h3>
                            <p class="product-stock">Estoque: <span id="selected-product-stock">0</span> unidades</p>
                            <p class="product-price-original">Pre√ßo original: <span id="selected-product-price">R$ 0,00</span></p>
                        </div>
                    </div>
                </div>

                <div class="product-config-section">
                    <div class="config-row">
                        <div class="config-group">
                            <label for="product-quantity">üìä Quantidade</label>
                            <div class="quantity-input-group">
                                <button type="button" class="qty-btn minus" onclick="adjustQuantity(-1)">‚àí</button>
                                <input type="number" id="product-quantity" min="1" max="999" value="1" onchange="updateProductTotal()">
                                <button type="button" class="qty-btn plus" onclick="adjustQuantity(1)">+</button>
                            </div>
                        </div>
                        
                        <div class="config-group">
                            <label for="product-custom-price">üí∞ Pre√ßo Unit√°rio</label>
                            <div class="price-input-group">
                                <span class="currency-symbol">R$</span>
                                <input type="text" id="product-custom-price" placeholder="0,00" onchange="updateProductTotal()" oninput="formatCurrencyInput(this)">
                            </div>
                        </div>
                    </div>
                    
                    <div class="total-preview">
                        <div class="total-calculation">
                            <span class="calculation-label">Subtotal:</span>
                            <span class="calculation-value" id="product-subtotal">R$ 0,00</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeAddProductModal()">‚ùå Cancelar</button>
                <button type="button" id="btn-confirm-add-product" class="btn btn-primary" onclick="confirmAddProduct()">‚úÖ Adicionar √† OS</button>
            </div>
        </div>
    </div>

    <!-- MODAL DE NOVA GARANTIA -->
    <div id="warranty-modal-container" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="warranty-modal-title">Nova Garantia</h2>
                <button id="btn-close-warranty-modal" class="close-modal-btn">&times;</button>
            </div>
            <div class="modal-body">
                <form id="new-warranty-form" class="os-form" novalidate>
                    <input type="hidden" id="warranty-edit-id">
                    
                    <!-- Se√ß√£o de Busca de OS -->
                    <fieldset>
                        <legend>üîç Buscar OS Entregue (Opcional)</legend>
                        <div class="form-group autocomplete-container">
                            <label>Buscar OS Entregue para Preenchimento Autom√°tico</label>
                            <input type="text" id="warranty-os-search" placeholder="Digite o n√∫mero da OS ou nome do cliente...">
                            <div id="warranty-os-results" class="autocomplete-results"></div>
                        </div>
                        <input type="hidden" id="warranty-selected-os-id">
                        <div class="form-group">
                            <small style="color: #666;">üí° Dica: Busque uma OS entregue para preencher automaticamente os dados do cliente, equipamento e pe√ßas utilizadas.</small>
                        </div>
                    </fieldset>

                    <!-- Se√ß√£o do Cliente -->
                    <fieldset>
                        <legend>1. Cliente</legend>
                        <div class="form-group autocomplete-container">
                            <label>Buscar Cliente Existente</label>
                            <input type="text" id="warranty-customer-search" placeholder="Digite o nome para buscar...">
                            <div id="warranty-customer-results" class="autocomplete-results"></div>
                        </div>
                        <input type="hidden" id="warranty-selected-customer-id">
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>Nome do Cliente *</label>
                                <input type="text" id="warranty-customer-name" required>
                            </div>
                            <div class="form-group">
                                <label>Telefone</label>
                                <input type="tel" id="warranty-customer-phone" placeholder="(XX) XXXXX-XXXX">
                            </div>
                        </div>
                    </fieldset>

                    <!-- Se√ß√£o do Equipamento -->
                    <fieldset>
                        <legend>2. Equipamento</legend>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Marca do Equipamento *</label>
                                <input type="text" id="warranty-equipment-brand" required>
                            </div>
                            <div class="form-group">
                                <label>Modelo do Equipamento *</label>
                                <input type="text" id="warranty-equipment-model" required>
                            </div>
                        </div>
                    </fieldset>

                    <!-- Se√ß√£o do Reparo -->
                    <fieldset>
                        <legend>3. Detalhes do Reparo</legend>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Pe√ßa que foi Substitu√≠da *</label>
                                <input type="text" id="warranty-part-replaced" required placeholder="Ex: FRONTAL, BATERIA, TELA">
                            </div>
                            <div class="form-group">
                                <label>Valor Total (R$) *</label>
                                <input type="text" id="warranty-total-value" required placeholder="Ex: 130,00">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Data do Reparo *</label>
                                <input type="date" id="warranty-repair-date" required>
                            </div>
                            <div class="form-group">
                                <label>Per√≠odo de Garantia (dias) *</label>
                                <input type="number" id="warranty-period-days" required value="90" min="1" max="365" placeholder="Ex: 90">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Observa√ß√µes Adicionais</label>
                            <textarea id="warranty-observations" rows="3" placeholder="Informa√ß√µes extras sobre o reparo..."></textarea>
                        </div>
                    </fieldset>

                    <div class="form-actions modal-actions">
                        <button type="submit" class="btn btn-primary">üíæ Salvar Garantia</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- MODAL DE VISUALIZA√á√ÉO DA GARANTIA -->
    <div id="warranty-view-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="warranty-view-title">Detalhes da Garantia</h2>
                <button id="btn-close-warranty-view-modal" class="close-modal-btn">&times;</button>
            </div>
            <div class="modal-body" id="warranty-view-body">
                <!-- Conte√∫do ser√° preenchido dinamicamente -->
            </div>
            <div class="modal-footer">
                <button id="warranty-print-btn" class="btn btn-primary">üñ®Ô∏è Imprimir Garantia</button>
            </div>
        </div>
    </div>

    <!-- MODAL DE EDI√á√ÉO DA GARANTIA -->
    <div id="warranty-edit-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="warranty-edit-title">Editar Garantia</h2>
                <button id="btn-close-warranty-edit-modal" class="close-modal-btn">&times;</button>
            </div>
            <div class="modal-body">
                <form id="edit-warranty-form" class="os-form" novalidate>
                    <input type="hidden" id="edit-warranty-id">
                    
                    <!-- Se√ß√£o do Cliente -->
                    <fieldset>
                        <legend>1. Cliente</legend>
                        <div class="form-group autocomplete-container">
                            <label>Buscar Cliente Existente</label>
                            <input type="text" id="edit-warranty-customer-search" placeholder="Digite o nome para buscar...">
                            <div id="edit-warranty-customer-results" class="autocomplete-results"></div>
                        </div>
                        <input type="hidden" id="edit-warranty-selected-customer-id">
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>Nome do Cliente *</label>
                                <input type="text" id="edit-warranty-customer-name" required>
                            </div>
                            <div class="form-group">
                                <label>Telefone</label>
                                <input type="tel" id="edit-warranty-customer-phone" placeholder="(XX) XXXXX-XXXX">
                            </div>
                        </div>
                    </fieldset>

                    <!-- Se√ß√£o do Equipamento -->
                    <fieldset>
                        <legend>2. Equipamento</legend>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Marca do Equipamento *</label>
                                <input type="text" id="edit-warranty-equipment-brand" required>
                            </div>
                            <div class="form-group">
                                <label>Modelo do Equipamento *</label>
                                <input type="text" id="edit-warranty-equipment-model" required>
                            </div>
                        </div>
                    </fieldset>

                    <!-- Se√ß√£o do Reparo -->
                    <fieldset>
                        <legend>3. Detalhes do Reparo</legend>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Pe√ßa que foi Substitu√≠da *</label>
                                <input type="text" id="edit-warranty-part-replaced" required placeholder="Ex: FRONTAL, BATERIA, TELA">
                            </div>
                            <div class="form-group">
                                <label>Valor Total (R$) *</label>
                                <input type="text" id="edit-warranty-total-value" required placeholder="Ex: 130,00">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Data do Reparo *</label>
                                <input type="date" id="edit-warranty-repair-date" required>
                            </div>
                            <div class="form-group">
                                <label>Per√≠odo de Garantia (dias) *</label>
                                <input type="number" id="edit-warranty-period-days" required value="90" min="1" max="365" placeholder="Ex: 90">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Observa√ß√µes Adicionais</label>
                            <textarea id="edit-warranty-observations" rows="3" placeholder="Informa√ß√µes extras sobre o reparo..."></textarea>
                        </div>
                    </fieldset>

                    <div class="form-actions modal-actions">
                        <button type="button" id="btn-cancel-edit-warranty" class="btn btn-secondary">Cancelar</button>
                        <button type="submit" class="btn btn-primary">üíæ Salvar Altera√ß√µes</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal de Confirma√ß√£o de Entrega -->
    <div id="delivery-confirmation-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚úÖ Confirmar Entrega</h2>
                <button id="btn-close-delivery-confirmation" class="close-modal-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; padding: 20px;">
                    <div style="font-size: 48px; margin-bottom: 20px;">üì¶</div>
                    <h3>Confirmar entrega da OS?</h3>
                    <p style="color: var(--medium-gray); margin: 20px 0;">Esta a√ß√£o marcar√° a ordem de servi√ßo como entregue e abrir√° o modal de pagamento.</p>
                    <p style="font-weight: bold; color: var(--primary-color);">OS #<span id="delivery-confirmation-os-id"></span></p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="btn-cancel-delivery" class="btn btn-secondary">‚ùå Cancelar</button>
                <button type="button" id="btn-confirm-delivery" class="btn btn-primary">‚úÖ Confirmar Entrega</button>
            </div>
        </div>
    </div>

    <!-- Modal de Pagamento da OS -->
    <div id="os-payment-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üí∞ Pagamento da OS</h2>
                <button id="btn-close-os-payment" class="close-modal-btn">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="os-payment-os-id">
                <input type="hidden" id="os-payment-cash-register-id">
                <input type="hidden" id="os-payment-products">
                
                <div class="payment-summary">
                    <h3>Resumo do Pagamento</h3>
                    <div class="total-display">
                        <span>Total a Pagar: </span>
                        <strong id="os-payment-total">R$ 0,00</strong>
                    </div>
                </div>

                <div class="payment-methods-section">
                    <h3>Forma de Pagamento</h3>
                    <div id="os-payment-methods" class="payment-methods-grid">
                        <div class="payment-method-item">
                            <label>üíµ Dinheiro:</label>
                            <input type="text" id="os-payment-dinheiro" placeholder="0,00" class="payment-input">
                        </div>
                        <div class="payment-method-item">
                            <label>üí≥ Cart√£o de Cr√©dito:</label>
                            <input type="text" id="os-payment-credito" placeholder="0,00" class="payment-input">
                        </div>
                        <div class="payment-method-item">
                            <label>üí≥ Cart√£o de D√©bito:</label>
                            <input type="text" id="os-payment-debito" placeholder="0,00" class="payment-input">
                        </div>
                        <div class="payment-method-item">
                            <label>üì± PIX:</label>
                            <input type="text" id="os-payment-pix" placeholder="0,00" class="payment-input">
                        </div>
                    </div>
                    
                    <div class="payment-summary-info">
                        <div class="payment-total-paid">
                            <span>Valor Pago: </span>
                            <strong id="os-payment-amount-paid">R$ 0,00</strong>
                        </div>
                        <div class="payment-remaining">
                            <span>Restante: </span>
                            <strong id="os-payment-remaining">R$ 0,00</strong>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="btn-cancel-os-payment" class="btn btn-secondary">‚ùå Cancelar</button>
                <button type="button" id="btn-finish-payment-os" class="btn btn-primary">‚úÖ Finalizar Pagamento</button>
            </div>
        </div>
    </div>

    <!-- MODAL DE CADASTRO DE NOVO CLIENTE (PARA OS) -->
    <div id="new-customer-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üë§ Cadastrar Novo Cliente</h2>
                <button id="btn-close-new-customer-modal" class="close-modal-btn">&times;</button>
            </div>
            <div class="modal-body">
                <form id="new-customer-modal-form" class="os-form" novalidate>
                    <!-- Informa√ß√µes B√°sicas -->
                    <fieldset>
                        <legend>Informa√ß√µes Pessoais</legend>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Nome Completo *</label>
                                <input type="text" id="modal-new-customer-name" required placeholder="Digite o nome completo">
                            </div>
                            <div class="form-group">
                                <label>Telefone</label>
                                <input type="tel" id="modal-new-customer-phone" placeholder="(XX) XXXXX-XXXX">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>Data de Nascimento</label>
                                <input type="date" id="modal-new-customer-birth-date">
                            </div>
                            <div class="form-group">
                                <label>CEP</label>
                                <input type="text" id="modal-new-customer-zip" placeholder="00000-000">
                            </div>
                        </div>
                    </fieldset>

                    <!-- Endere√ßo -->
                    <fieldset>
                        <legend>Endere√ßo</legend>
                        <div class="form-row">
                            <div class="form-group" style="flex: 3;">
                                <label>Logradouro (Rua, Av.)</label>
                                <input type="text" id="modal-new-customer-street" placeholder="Nome da rua">
                            </div>
                            <div class="form-group" style="flex: 1;">
                                <label>N√∫mero</label>
                                <input type="text" id="modal-new-customer-number" placeholder="123">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>Bairro</label>
                                <input type="text" id="modal-new-customer-neighborhood" placeholder="Nome do bairro">
                            </div>
                            <div class="form-group">
                                <label>Cidade</label>
                                <input type="text" id="modal-new-customer-city" placeholder="Nome da cidade">
                            </div>
                            <div class="form-group" style="flex: 0.5;">
                                <label>Estado</label>
                                <input type="text" id="modal-new-customer-state" placeholder="UF" maxlength="2">
                            </div>
                        </div>
                    </fieldset>

                    <div class="form-actions modal-actions">
                        <button type="button" id="btn-cancel-new-customer-modal" class="btn btn-secondary">‚ùå Cancelar</button>
                        <button type="submit" class="btn btn-primary">üíæ Salvar Cliente</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Script para controle do menu mobile -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
            const dashboardSidebar = document.getElementById('dashboard-sidebar');
            const sidebarOverlay = document.getElementById('sidebar-overlay');
            
            // Fun√ß√£o para abrir o menu mobile
            function openMobileMenu() {
                dashboardSidebar.classList.add('mobile-open');
                sidebarOverlay.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
            
            // Fun√ß√£o para fechar o menu mobile
            function closeMobileMenu() {
                dashboardSidebar.classList.remove('mobile-open');
                sidebarOverlay.classList.remove('active');
                document.body.style.overflow = '';
            }
            
            // Event listeners
            mobileMenuToggle.addEventListener('click', openMobileMenu);
            sidebarOverlay.addEventListener('click', closeMobileMenu);
            
            // Fechar menu ao clicar em um item de navega√ß√£o (mobile)
            const navItems = document.querySelectorAll('.sidebar-nav .nav-item a');
            navItems.forEach(item => {
                item.addEventListener('click', function() {
                    if (window.innerWidth <= 768) {
                        closeMobileMenu();
                    }
                });
            });
            
            // Fechar menu ao redimensionar para desktop
            window.addEventListener('resize', function() {
                if (window.innerWidth > 768) {
                    closeMobileMenu();
                }
            });
        });
    </script>
</body>
</html>
